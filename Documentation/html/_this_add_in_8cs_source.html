<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SuiteCRM Outlook Add-in: SuiteCRMAddIn/ThisAddIn.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="SuiteCRM.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SuiteCRM Outlook Add-in
   &#160;<span id="projectnumber">3.0.22.0</span>
   </div>
   <div id="projectbrief">An outlook add-in which allows synchronisation with SuiteCRM</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_this_add_in_8cs_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ThisAddIn.cs</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_this_add_in_8cs.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_suite_c_r_m_add_in.html">SuiteCRMAddIn</a></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keyword">using</span> BusinessLogic;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">using</span> Daemon;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">using</span> Dialogs;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keyword">using</span> Extensions;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keyword">using</span> Helpers;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keyword">using</span> Microsoft.<a class="code" href="namespace_office.html">Office</a>.Core;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_n_gettext.html">NGettext</a>;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keyword">using</span> Properties;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a>.<a class="code" href="namespace_suite_c_r_m_client_1_1_email.html">Email</a>;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a>.<a class="code" href="namespace_suite_c_r_m_client_1_1_logging.html">Logging</a>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a>.<a class="code" href="namespace_suite_c_r_m_client_1_1_r_e_s_t_objects.html">RESTObjects</a>;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Collections.Generic;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Linq;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Reflection;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Runtime.InteropServices;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Text;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Threading;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Windows.Forms;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_office.html">Office</a> = Microsoft.Office.Core;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_outlook.html">Outlook</a> = Microsoft.Office.Interop.Outlook;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html">   50</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">partial class </span><a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html">ThisAddIn</a></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    {</div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a59e3329b343e57d18faafdc4a0c4ee03">   52</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a59e3329b343e57d18faafdc4a0c4ee03">ProgId</a> = <span class="stringliteral">&quot;SuiteCRMAddIn&quot;</span>;</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a078b072a3e77ab54327124942b24db2d">   53</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">static</span> readonly <span class="keywordtype">string</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a078b072a3e77ab54327124942b24db2d">AddInTitle</a>, AddInVersion;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a91947c0f74700ebb78a18258279fe8a4">   55</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a>.<a class="code" href="class_suite_c_r_m_client_1_1_user_session.html">UserSession</a> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a91947c0f74700ebb78a18258279fe8a4">SuiteCRMUserSession</a>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keyword">private</span> <a class="code" href="namespace_outlook.html">Outlook</a>.Explorer objExplorer;</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a89f35eb63bc93448017eeda72408096e">   57</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_office.html">Office</a>.CommandBarPopup <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a89f35eb63bc93448017eeda72408096e">objSuiteCRMMenuBar2007</a>;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a4b3b3ac7e3fcfa7ec447a4729be4ee4f">   58</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_office.html">Office</a>.CommandBarButton <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a4b3b3ac7e3fcfa7ec447a4729be4ee4f">btnArchive</a>;</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a52d06a085d6217241ad5d444bec7188d">   59</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_office.html">Office</a>.CommandBarButton <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a52d06a085d6217241ad5d444bec7188d">btnSettings</a>;</div><div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aa46936bb917201fce8670a4de7f50649">   60</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_suite_c_r_m_add_in.html#a0299c983ae44fbfee337a7d4312b04af">OutlookMajorVersion</a> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aa46936bb917201fce8670a4de7f50649">OutlookVersion</a>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keyword">private</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context.html">SyncContext</a> synchronisationContext;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keyword">private</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_synchroniser.html">ContactSynchroniser</a> contactSynchroniser;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keyword">private</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_synchroniser.html">TaskSynchroniser</a> taskSynchroniser;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keyword">private</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_meetings_synchroniser.html">MeetingsSynchroniser</a> meetingSynchroniser;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keyword">private</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_calls_synchroniser.html">CallsSynchroniser</a> callSynchroniser;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70b83a2731db0d1f8c1958c27240fc82">   71</a></span>&#160;        <span class="keyword">internal</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_calls_synchroniser.html">CallsSynchroniser</a> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_calls_synchroniser.html">CallsSynchroniser</a> =&gt; this.callSynchroniser;</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a86ebbad56f266bb74375ebcc414f2347">   75</a></span>&#160;        <span class="keyword">internal</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_meetings_synchroniser.html">MeetingsSynchroniser</a> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_meetings_synchroniser.html">MeetingsSynchroniser</a> =&gt; this.meetingSynchroniser;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8425742ee8ea655955254316a4a7a60e">   77</a></span>&#160;        <span class="keyword">internal</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_synchroniser.html">ContactSynchroniser</a> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8425742ee8ea655955254316a4a7a60e">ContactsSynchroniser</a> =&gt; this.contactSynchroniser;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#afbf26faf3e59aa086fddc4b13fb62793">   82</a></span>&#160;        <span class="keyword">public</span> ICatalog <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#afbf26faf3e59aa086fddc4b13fb62793">catalogue</a> = <span class="keyword">new</span> Catalog(ProgId, <span class="stringliteral">&quot;./Locale&quot;</span>);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a7c85364b85b111f650f55b5c2e090e0c">   84</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="namespace_office.html">Office</a>.IRibbonUI <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a7c85364b85b111f650f55b5c2e090e0c">RibbonUI</a> { <span class="keyword">get</span>; <span class="keyword">set</span>; }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keyword">public</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_email_archiving.html">EmailArchiving</a> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a059ba6330fe696daba3c216994fd5fc7">EmailArchiver</a></div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a059ba6330fe696daba3c216994fd5fc7">   86</a></span>&#160;        {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keyword">private</span> <a class="code" href="interface_suite_c_r_m_client_1_1_logging_1_1_i_logger.html">ILogger</a> log;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keyword">public</span> <a class="code" href="interface_suite_c_r_m_client_1_1_logging_1_1_i_logger.html">ILogger</a> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a></div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">   98</a></span>&#160;        {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="keyword">get</span> { <span class="keywordflow">return</span> this.log; }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keyword">static</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html">ThisAddIn</a>()</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            GetTitleAndVersion(out AddInTitle, out AddInVersion);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> VerifyLicenceKey()</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                result = <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_helpers_1_1_licence_validation_helper.html">LicenceValidationHelper</a>(this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>, Properties.Settings.Default.PublicKey, Properties.Settings.Default.LicenceKey).<a class="code" href="class_suite_c_r_m_add_in_1_1_helpers_1_1_licence_validation_helper.html#ad940fcca799f5eb17338aa71ee8a3753">Validate</a>();</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_system.html">System</a>.Configuration.SettingsPropertyNotFoundException ex)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                this.log.Error(catalogue.GetString(<span class="stringliteral">&quot;Licence key was not yet set up&quot;</span>), ex);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#ac6234db8eca55ca418b5043365bfdec3">HasCrmUserSession</a></div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#ac6234db8eca55ca418b5043365bfdec3">  131</a></span>&#160;        {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keyword">get</span> { <span class="keywordflow">return</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a91947c0f74700ebb78a18258279fe8a4">SuiteCRMUserSession</a>?.<a class="code" href="class_suite_c_r_m_client_1_1_user_session.html#a877b89070d382c035608e3ec35d97963">IsLoggedIn</a> ?? <span class="keyword">false</span>; }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> ThisAddIn_Startup(<span class="keywordtype">object</span> sender, <a class="code" href="namespace_system.html">System</a>.EventArgs e)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="comment">/* we need logging before we start the daemon */</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            StartLogging();</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_daemon_1_1_daemon_worker.html">DaemonWorker</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_daemon_1_1_daemon_worker.html#a7cd50a597c99ce8c1167eee208224e37">Instance</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_daemon_1_1_daemon_worker.html#a759291681be3f2fd27ee7e82f0547fb6">AddTask</a>(<span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_daemon_1_1_deferred_startup_action.html">DeferredStartupAction</a>());</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a0e2dbad2cebfd48a2db67c4b9f22d2b3">  149</a></span>&#160;        <span class="keyword">internal</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a0e2dbad2cebfd48a2db67c4b9f22d2b3">DeferredStartup</a>()</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                Prepare();</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                Thread background = <span class="keyword">new</span> Thread(() =&gt; Run());</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                background.Name = <span class="stringliteral">&quot;Background&quot;</span>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                background.Start();</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                log.Error(<span class="stringliteral">&quot;ThisAddIn.ThisAddIn_Startup&quot;</span>, ex);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            }</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> Prepare()</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            var outlookApp = this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a01bdbe5957bd96dfaf5845461aff26e8">Application</a>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            this.MaybeUpgradeSettings();</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            OutlookVersion = (<a class="code" href="namespace_suite_c_r_m_add_in.html#a0299c983ae44fbfee337a7d4312b04af">OutlookMajorVersion</a>)Convert.ToInt32(outlookApp.Version.Split(<span class="charliteral">&#39;.&#39;</span>)[0]);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            synchronisationContext = <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context.html">SyncContext</a>(outlookApp);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            callSynchroniser = <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70b83a2731db0d1f8c1958c27240fc82">CallsSynchroniser</a>(<span class="stringliteral">&quot;AS&quot;</span>, synchronisationContext);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            contactSynchroniser = <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_synchroniser.html">ContactSynchroniser</a>(<span class="stringliteral">&quot;CS&quot;</span>, synchronisationContext);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            meetingSynchroniser = <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a86ebbad56f266bb74375ebcc414f2347">MeetingsSynchroniser</a>(<span class="stringliteral">&quot;MS&quot;</span>, synchronisationContext);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            taskSynchroniser = <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_synchroniser.html">TaskSynchroniser</a>(<span class="stringliteral">&quot;TS&quot;</span>, synchronisationContext);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a059ba6330fe696daba3c216994fd5fc7">EmailArchiver</a> = <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_email_archiving.html">EmailArchiving</a>(<span class="stringliteral">&quot;EM&quot;</span>, synchronisationContext.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context.html#ac800c823d97baf0a18035333cb1fbe2d">Log</a>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            var outlookExplorer = outlookApp.ActiveExplorer();</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            this.objExplorer = outlookExplorer;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            outlookExplorer.FolderSwitch -= objExplorer_FolderSwitch;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            outlookExplorer.FolderSwitch += objExplorer_FolderSwitch;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="comment">// TODO: install/remove these event handlers when settings.AutoArchive changes:</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            outlookApp.NewMailEx += <span class="keyword">new</span> <a class="code" href="namespace_outlook.html">Outlook</a>.ApplicationEvents_11_NewMailExEventHandler(this.Application_NewMail);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            outlookApp.ItemSend += <span class="keyword">new</span> <a class="code" href="namespace_outlook.html">Outlook</a>.ApplicationEvents_11_ItemSendEventHandler(this.Application_ItemSend);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            ((<a class="code" href="namespace_outlook.html">Outlook</a>.ApplicationEvents_11_Event)<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a01bdbe5957bd96dfaf5845461aff26e8">Application</a>).Quit += <span class="keyword">new</span> <a class="code" href="namespace_outlook.html">Outlook</a>.ApplicationEvents_11_QuitEventHandler(ThisAddIn_Quit);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keywordflow">if</span> (OutlookVersion &lt; <a class="code" href="namespace_suite_c_r_m_add_in.html#a0299c983ae44fbfee337a7d4312b04af">OutlookMajorVersion</a>.Outlook2010)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                outlookApp.ItemContextMenuDisplay += <span class="keyword">new</span> <a class="code" href="namespace_outlook.html">Outlook</a>.ApplicationEvents_11_ItemContextMenuDisplayEventHandler(this.Application_ItemContextMenuDisplay);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                var menuBar = outlookExplorer.CommandBars.ActiveMenuBar;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a89f35eb63bc93448017eeda72408096e">objSuiteCRMMenuBar2007</a> = (<a class="code" href="namespace_office.html">Office</a>.CommandBarPopup)menuBar.Controls.Add(<a class="code" href="namespace_office.html">Office</a>.MsoControlType.msoControlPopup, missing, missing, missing, <span class="keyword">true</span>);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a89f35eb63bc93448017eeda72408096e">objSuiteCRMMenuBar2007</a> != null)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                    ConstructOutlook2007MenuBar();</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a912a8f4c13342a9f8673693b8424f90c">  206</a></span>&#160;        <span class="keyword">internal</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a912a8f4c13342a9f8673693b8424f90c">ManualSyncContact</a>()</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_dialogs_1_1_manual_sync_contact_form.html">ManualSyncContactForm</a>(<span class="keywordtype">string</span>.Join(<span class="stringliteral">&quot;; &quot;</span>, <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a0cb1559d67fa90a6f9a7e423e9e6d0fd">SelectedContacts</a>.Select(x =&gt; $<span class="stringliteral">&quot;{x.FullName}, {x.Email1Address}&quot;</span>))).ShowDialog();</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> MaybeUpgradeSettings()</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="comment">/* Attempt to fix &#39;settings getting wiped&#39; bug #187;</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">             * see https://stackoverflow.com/questions/2201819/why-are-persisted-user-settings-not-loaded</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html">Settings</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a906a8cf6ad39360af6fcb416ada8068c">Default</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a70a256c8149998293464ae1c47294fd4">NeedsUpgrade</a>)</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html">Settings</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a906a8cf6ad39360af6fcb416ada8068c">Default</a>.Upgrade();</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html">Settings</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a906a8cf6ad39360af6fcb416ada8068c">Default</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a70a256c8149998293464ae1c47294fd4">NeedsUpgrade</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html">Settings</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a906a8cf6ad39360af6fcb416ada8068c">Default</a>.Save();</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="comment">/* The above doesn&#39;t always work; Settings.Default.NeedsUpgrade doesn&#39;t</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">             * always fire when it should. I hypothesise that this is because we are</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">             * an Add-in, not a first class application, and our settings directory</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">             * actually tracks the Microsoft Office version. So check if a key setting</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">             * is missing, and if it is, attempt upgrade.</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (String.IsNullOrWhiteSpace(<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html">Settings</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a906a8cf6ad39360af6fcb416ada8068c">Default</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a5b5f32edfea37ca1a3f1d568b3ae52ac">LicenceKey</a>))</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Debug(<span class="stringliteral">&quot;No licence key? Trying upgrade...&quot;</span>);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html">Settings</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a906a8cf6ad39360af6fcb416ada8068c">Default</a>.Upgrade();</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html">Settings</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a906a8cf6ad39360af6fcb416ada8068c">Default</a>.Save();</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Debug(<span class="stringliteral">&quot;Upgrade succeeded.&quot;</span>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> any)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                    <span class="comment">/* This will fail in the case of a new installation, but that&#39;s OK. </span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">                     * However, log it, in case it also fails at other times. */</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_error_handler.html">ErrorHandler</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_error_handler.html#aa5ac5699b0099c7a812a895751df5e07">Handle</a>(<span class="stringliteral">&quot;Failure while attempting to upgrade settings.&quot;</span>, any);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> ConstructOutlook2007MenuBar()</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a89f35eb63bc93448017eeda72408096e">objSuiteCRMMenuBar2007</a>.Caption = <span class="stringliteral">&quot;SuiteCRM&quot;</span>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a4b3b3ac7e3fcfa7ec447a4729be4ee4f">btnArchive</a> = (<a class="code" href="namespace_office.html">Office</a>.CommandBarButton)this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a89f35eb63bc93448017eeda72408096e">objSuiteCRMMenuBar2007</a>.Controls.Add(<a class="code" href="namespace_office.html">Office</a>.MsoControlType.msoControlButton, <a class="code" href="namespace_system.html">System</a>.Type.Missing, <a class="code" href="namespace_system.html">System</a>.Type.Missing, <a class="code" href="namespace_system.html">System</a>.Type.Missing, <span class="keyword">true</span>);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a4b3b3ac7e3fcfa7ec447a4729be4ee4f">btnArchive</a>.Style = <a class="code" href="namespace_office.html">Office</a>.MsoButtonStyle.msoButtonIconAndCaption;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a4b3b3ac7e3fcfa7ec447a4729be4ee4f">btnArchive</a>.Caption = catalogue.GetString(<span class="stringliteral">&quot;Archive&quot;</span>);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a4b3b3ac7e3fcfa7ec447a4729be4ee4f">btnArchive</a>.Picture = <a class="code" href="class_suite_c_r_m_add_in_1_1_ribbon_image_helper.html">RibbonImageHelper</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_ribbon_image_helper.html#ab6c37f7066ccafd90143fe3803cb3c8b">Convert</a>(<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_resources.html">Resources</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_resources.html#a186368c19174d13c48724c8d5b6cd39b">SuiteCRMLogo</a>);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a4b3b3ac7e3fcfa7ec447a4729be4ee4f">btnArchive</a>.Enabled &amp;= this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#ac6234db8eca55ca418b5043365bfdec3">HasCrmUserSession</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a4b3b3ac7e3fcfa7ec447a4729be4ee4f">btnArchive</a>.Click += <span class="keyword">new</span> <a class="code" href="namespace_office.html">Office</a>._CommandBarButtonEvents_ClickEventHandler(this.cbtnArchive_Click);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a4b3b3ac7e3fcfa7ec447a4729be4ee4f">btnArchive</a>.Visible = <span class="keyword">true</span>;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a4b3b3ac7e3fcfa7ec447a4729be4ee4f">btnArchive</a>.BeginGroup = <span class="keyword">true</span>;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a4b3b3ac7e3fcfa7ec447a4729be4ee4f">btnArchive</a>.TooltipText = catalogue.GetString(<span class="stringliteral">&quot;Archive selected emails to SuiteCRM&quot;</span>);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a4b3b3ac7e3fcfa7ec447a4729be4ee4f">btnArchive</a>.Enabled = <span class="keyword">true</span>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a52d06a085d6217241ad5d444bec7188d">btnSettings</a> = (<a class="code" href="namespace_office.html">Office</a>.CommandBarButton)this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a89f35eb63bc93448017eeda72408096e">objSuiteCRMMenuBar2007</a>.Controls.Add(<a class="code" href="namespace_office.html">Office</a>.MsoControlType.msoControlButton, <a class="code" href="namespace_system.html">System</a>.Type.Missing, <a class="code" href="namespace_system.html">System</a>.Type.Missing, <a class="code" href="namespace_system.html">System</a>.Type.Missing, <span class="keyword">true</span>);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a52d06a085d6217241ad5d444bec7188d">btnSettings</a>.Style = <a class="code" href="namespace_office.html">Office</a>.MsoButtonStyle.msoButtonIconAndCaption;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a52d06a085d6217241ad5d444bec7188d">btnSettings</a>.Caption = catalogue.GetString(<span class="stringliteral">&quot;Settings&quot;</span>);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a52d06a085d6217241ad5d444bec7188d">btnSettings</a>.Click += <span class="keyword">new</span> <a class="code" href="namespace_office.html">Office</a>._CommandBarButtonEvents_ClickEventHandler(this.cbtnSettings_Click);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a52d06a085d6217241ad5d444bec7188d">btnSettings</a>.Visible = <span class="keyword">true</span>;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a52d06a085d6217241ad5d444bec7188d">btnSettings</a>.BeginGroup = <span class="keyword">true</span>;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a52d06a085d6217241ad5d444bec7188d">btnSettings</a>.TooltipText = catalogue.GetString(<span class="stringliteral">&quot;SuiteCRM Settings&quot;</span>);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a52d06a085d6217241ad5d444bec7188d">btnSettings</a>.Enabled = <span class="keyword">true</span>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a52d06a085d6217241ad5d444bec7188d">btnSettings</a>.Picture = <a class="code" href="class_suite_c_r_m_add_in_1_1_ribbon_image_helper.html">RibbonImageHelper</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_ribbon_image_helper.html#ab6c37f7066ccafd90143fe3803cb3c8b">Convert</a>(<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_resources.html">Resources</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_resources.html#a0b08bb92aff67652dcb680702f91e139">Settings</a>);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a89f35eb63bc93448017eeda72408096e">objSuiteCRMMenuBar2007</a>.Visible = <span class="keyword">true</span>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        }</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> Run()</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordtype">bool</span> success = <span class="keyword">false</span>, disable = <span class="keyword">false</span>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="keywordflow">for</span> (success = <span class="keyword">false</span>; !(success || disable);)</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                success = this.VerifyLicenceKey();</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                <span class="keywordflow">if</span> (success)</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                    log.Info(catalogue.GetString(<span class="stringliteral">&quot;Licence verified...&quot;</span>));</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    success = this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a7079a786abcf4e8a54fe271e79838ff1">SuiteCRMAuthenticate</a>();</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    <span class="keywordflow">if</span> (success)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                        log.Info(catalogue.GetString(<span class="stringliteral">&quot;Authentication succeeded...&quot;</span>));</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                    }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                        disable = this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a5a59515dac58ee4eb1169adf2f3d597b">ShowReconfigureOrDisable</a>(catalogue.GetString(<span class="stringliteral">&quot;Login to CRM failed&quot;</span>), <span class="keyword">true</span>) == DialogResult.Cancel;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    disable = this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a5a59515dac58ee4eb1169adf2f3d597b">ShowReconfigureOrDisable</a>(catalogue.GetString(<span class="stringliteral">&quot;Licence check failed&quot;</span>), <span class="keyword">true</span>) == DialogResult.Cancel;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keywordflow">if</span> (success &amp;&amp; !disable)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                log.Info(catalogue.GetString(<span class="stringliteral">&quot;Starting normal operations.&quot;</span>));</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_daemon_1_1_daemon_worker.html">DaemonWorker</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_daemon_1_1_daemon_worker.html#a7cd50a597c99ce8c1167eee208224e37">Instance</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_daemon_1_1_daemon_worker.html#a759291681be3f2fd27ee7e82f0547fb6">AddTask</a>(<span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_daemon_1_1_fetch_email_categories_action.html">FetchEmailCategoriesAction</a>());</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a64093b46d58d23f3bb0e866e299745ba">StartConfiguredSynchronisationProcesses</a>();</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aff2091c03ba97186e5d01f74806bd63a">IsLicensed</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (disable)</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                log.Info(catalogue.GetString(<span class="stringliteral">&quot;Disabling addin at user request&quot;</span>));</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a98cbecd9f92c5928ca248bc4b40b6b62">Disable</a>();</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="comment">/* it&#39;s possible for both success AND disable to be true (if login to CRM fails); </span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">                 * but logically if success is false disable must be true, so this branch should</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">                 * never be reached. */</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Error(</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                    catalogue.GetString(</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                        <span class="stringliteral">&quot;In {0}: success is {1}; disable is {2}; impossible state, disabling.&quot;</span>,</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                        <span class="stringliteral">&quot;ThisAddIn.Run&quot;</span>,</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                        success,</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                        disable));</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a98cbecd9f92c5928ca248bc4b40b6b62">Disable</a>();</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a98cbecd9f92c5928ca248bc4b40b6b62">  335</a></span>&#160;        <span class="keyword">internal</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a98cbecd9f92c5928ca248bc4b40b6b62">Disable</a>()</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">string</span> methodName = <span class="stringliteral">&quot;ThisAddIn.Disable&quot;</span>;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Warn(catalogue.GetString(<span class="stringliteral">&quot;Disabling add-in&quot;</span>));</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <span class="keywordflow">foreach</span> (COMAddIn addin <span class="keywordflow">in</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a01bdbe5957bd96dfaf5845461aff26e8">Application</a>.COMAddIns)</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                <span class="keywordflow">if</span> (ProgId.Equals(addin.ProgId))</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Debug(catalogue.GetString(<span class="stringliteral">&quot;{0}: Disabling instance {1} of addin {2}&quot;</span>, methodName, ++i, ProgId));</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    addin.Connect = <span class="keyword">false</span>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                {</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Debug(catalogue.GetString(<span class="stringliteral">&quot;{0}: Ignoring addin {1}&quot;</span>, methodName, addin.ProgId));</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="comment">// Application.COMAddIns.Item(ProgId).Connect = false;</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a5a59515dac58ee4eb1169adf2f3d597b">  363</a></span>&#160;        <span class="keyword">internal</span> DialogResult <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a5a59515dac58ee4eb1169adf2f3d597b">ShowReconfigureOrDisable</a>(<span class="keywordtype">string</span> summary, <span class="keywordtype">bool</span> allowRetry = <span class="keyword">false</span>)</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            DialogResult result;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            result = <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_dialogs_1_1_reconfigure_or_disable_dialog.html">ReconfigureOrDisableDialog</a>(summary, allowRetry).ShowDialog();</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keywordflow">switch</span> (result)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <span class="keywordflow">case</span> DialogResult.Retry:</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Info(catalogue.GetString(<span class="stringliteral">&quot;User chose to retry connection&quot;</span>));</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                <span class="keywordflow">case</span> DialogResult.OK:</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                    <span class="comment">/* if licence key does not validate, show the settings form to allow the user to enter</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">                     * a (new) key, and retry. */</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Info(catalogue.GetString(<span class="stringliteral">&quot;User chose to reconfigure add-in&quot;</span>));</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8e4511bd9e35cdd0b86024d96341990b">ShowSettingsForm</a>();</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                <span class="keywordflow">case</span> DialogResult.Cancel:</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Info(catalogue.GetString(<span class="stringliteral">&quot;User chose to disable add-in&quot;</span>));</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <span class="keywordflow">default</span>:</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                    log.Warn(catalogue.GetString(<span class="stringliteral">&quot;Unexpected response from ReconfigureOrDisableDialog&quot;</span>));</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    result = DialogResult.OK;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#afec23a14c60746240b13e5ddefccf4ae">  391</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">string</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#afec23a14c60746240b13e5ddefccf4ae">LogDirPath</a> =&gt;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) +</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            <span class="stringliteral">&quot;\\SuiteCRMOutlookAddIn\\Logs\\&quot;</span>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> StartLogging()</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            log = <a class="code" href="class_suite_c_r_m_add_in_1_1_log4_net_logger.html">Log4NetLogger</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_log4_net_logger.html#a55cc627fa46c34ecc33662ff09c977c8">FromFilePath</a>(<span class="stringliteral">&quot;add-in&quot;</span>, LogDirPath + <span class="stringliteral">&quot;suitecrmoutlook.log&quot;</span>, () =&gt; GetLogHeader(), Properties.Settings.Default.LogLevel);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <a class="code" href="class_suite_c_r_m_client_1_1_rest_a_p_i_wrapper.html">RestAPIWrapper</a>.<a class="code" href="class_suite_c_r_m_client_1_1_rest_a_p_i_wrapper.html#a0ffc33bcc99b1ee4d047cff56a560216">SetLog</a>(log);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> LogKeySettings()</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="keywordflow">foreach</span> (var s <span class="keywordflow">in</span> GetKeySettings())</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                log.Debug(s);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keyword">private</span> IEnumerable&lt;string&gt; GetLogHeader()</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            List&lt;string&gt; result = <span class="keyword">new</span> List&lt;string&gt;();</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                result.Add(catalogue.GetString(<span class="stringliteral">&quot;{0} v{1} in Outlook version {2}&quot;</span>, AddInTitle, AddInVersion, <span class="keyword">this</span>.Application.Version));</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                result.AddRange(GetKeySettings());</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> any)</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                result.Add(catalogue.GetString(<span class="stringliteral">&quot;Exception {0} &#39;{1}&#39; while printing log header&quot;</span>, any.GetType().Name, any.Message));</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keyword">private</span> IEnumerable&lt;string&gt; GetKeySettings()</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        {</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            yield <span class="keywordflow">return</span> catalogue.GetString(<span class="stringliteral">&quot;Auto-archiving: &quot;</span>) +</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                (<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html">Settings</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a906a8cf6ad39360af6fcb416ada8068c">Default</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a025428c4ea0b085cea9b45602e6d7ee5">AutoArchive</a> ? catalogue.GetString(<span class="stringliteral">&quot;ON&quot;</span>) : catalogue.GetString(<span class="stringliteral">&quot;off&quot;</span>));</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            yield <span class="keywordflow">return</span> catalogue.GetString(<span class="stringliteral">&quot;Logging level: {0}&quot;</span>, <a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html">Settings</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a906a8cf6ad39360af6fcb416ada8068c">Default</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#af9da6ec23fc6dc475185f3016344cf81">LogLevel</a>);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordtype">void</span> objExplorer_FolderSwitch()</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                synchronisationContext.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context.html#a09c4d2acefef124035da888b7a469313">SetCurrentFolder</a>(this.objExplorer.CurrentFolder);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_error_handler.html">ErrorHandler</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_error_handler.html#aa5ac5699b0099c7a812a895751df5e07">Handle</a>($<span class="stringliteral">&quot;Failure while attempting to change folder to {this.objExplorer.CurrentFolder.FolderPath}&quot;</span>, ex);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            }</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a64093b46d58d23f3bb0e866e299745ba">  449</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a64093b46d58d23f3bb0e866e299745ba">StartConfiguredSynchronisationProcesses</a>()</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            StartSynchroniserIfConfigured(this.callSynchroniser);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            StartSynchroniserIfConfigured(this.contactSynchroniser);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            StartSynchroniserIfConfigured(this.meetingSynchroniser);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            StartSynchroniserIfConfigured(this.taskSynchroniser);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            StartSynchroniserIfConfigured(this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a059ba6330fe696daba3c216994fd5fc7">EmailArchiver</a>);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aa11073e39b068391a2bb352942bd7cc9">  462</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aa11073e39b068391a2bb352942bd7cc9">StopUnconfiguredSynchronisationProcesses</a>()</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            StopSynchroniserIfUnconfigured(this.callSynchroniser);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            StopSynchroniserIfUnconfigured(this.contactSynchroniser);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            StopSynchroniserIfUnconfigured(this.meetingSynchroniser);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            StopSynchroniserIfUnconfigured(this.taskSynchroniser);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            StopSynchroniserIfUnconfigured(this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a059ba6330fe696daba3c216994fd5fc7">EmailArchiver</a>);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> StartSynchroniserIfConfigured(<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html">Synchroniser</a> synchroniser)</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        {</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keywordflow">if</span> (synchroniser != null &amp;&amp;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                synchroniser.Direction != <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html">SyncDirection</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html#aee195368e938ed8e05fa3ec669838c06">Direction</a>.Neither &amp;&amp;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                !synchroniser.IsActive)</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            {</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                DoOrLogError(() =&gt;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                    synchroniser.Start(),</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                    catalogue.GetString(<span class="stringliteral">&quot;Starting {0}&quot;</span>, <span class="keyword">new</span> <span class="keywordtype">object</span>[] { synchroniser.GetType().Name }));</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            }</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> StartSynchroniserIfConfigured(<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_email_archiving.html">EmailArchiving</a> archiver)</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <span class="keywordflow">if</span> (archiver != null &amp;&amp; <a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html">Settings</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a906a8cf6ad39360af6fcb416ada8068c">Default</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a025428c4ea0b085cea9b45602e6d7ee5">AutoArchive</a> == <span class="keyword">true</span> &amp;&amp; !archiver.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process.html#a708c4cbb44af74854ce2f236e78f2f9e">IsActive</a>)</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                DoOrLogError(() =&gt;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                    archiver.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process.html#a1807d77e723339e933844895c68b3b4f">Start</a>(),</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                    catalogue.GetString(<span class="stringliteral">&quot;Starting {0}&quot;</span>, <span class="keyword">new</span> <span class="keywordtype">object</span>[] { archiver.GetType().<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process.html#adb3223c50e803350f04dfaf1766641a4">Name</a> }));</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            }</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> StopSynchroniserIfUnconfigured(<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html">Synchroniser</a> synchroniser)</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        {</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <span class="keywordflow">if</span> (synchroniser != null &amp;&amp;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                synchroniser.Direction == <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html">SyncDirection</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html#aee195368e938ed8e05fa3ec669838c06">Direction</a>.Neither &amp;&amp;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                synchroniser.IsActive)</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            {</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                synchroniser.Stop();</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> StopSynchroniserIfUnconfigured(<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_email_archiving.html">EmailArchiving</a> archiver)</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        {</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="keywordflow">if</span> (archiver != null &amp;&amp; <a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html">Settings</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a906a8cf6ad39360af6fcb416ada8068c">Default</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a025428c4ea0b085cea9b45602e6d7ee5">AutoArchive</a> == <span class="keyword">false</span> &amp;&amp; archiver.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process.html#a708c4cbb44af74854ce2f236e78f2f9e">IsActive</a>)</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            {</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                archiver.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process.html#a1484b532908abdfad6640cc758cd2f37">Stop</a>();</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            }</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> cbtnArchive_Click(<a class="code" href="namespace_office.html">Office</a>.CommandBarButton Ctrl, ref <span class="keywordtype">bool</span> CancelDefault)</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8052836bf64ac24c9334d6ac28ec967e">ShowArchiveForm</a>();</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> cbtnSettings_Click(<a class="code" href="namespace_office.html">Office</a>.CommandBarButton Ctrl, ref <span class="keywordtype">bool</span> CancelDefault)</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            DoOrLogError(() =&gt;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8e4511bd9e35cdd0b86024d96341990b">ShowSettingsForm</a>());</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        }</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8e4511bd9e35cdd0b86024d96341990b">  544</a></span>&#160;        <span class="keyword">public</span> DialogResult <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8e4511bd9e35cdd0b86024d96341990b">ShowSettingsForm</a>()</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            var settingsForm = <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_dialogs_1_1_settings_dialog.html">SettingsDialog</a>();</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            settingsForm.SettingsChanged += (sender, args) =&gt; this.LogKeySettings();</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="keywordflow">return</span> settingsForm.ShowDialog();</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a5f4393ccf24f13b7921748075c8260ca">  551</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a5f4393ccf24f13b7921748075c8260ca">ShowAddressBook</a>()</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        {</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="keywordflow">if</span> (this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#ac6234db8eca55ca418b5043365bfdec3">HasCrmUserSession</a>)</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            {</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                DoOrLogError(() =&gt;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_dialogs_1_1frm_address_book.html">frmAddressBook</a>().ShowDialog());</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            }</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            {</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                MessageBox.Show(<span class="stringliteral">&quot;Please wait: SuiteSRM AddIn has not yet completed connections&quot;</span>, </div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                    <span class="stringliteral">&quot;Waiting for connection&quot;</span>, </div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                    MessageBoxButtons.OK);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        }</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8052836bf64ac24c9334d6ac28ec967e">  566</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8052836bf64ac24c9334d6ac28ec967e">ShowArchiveForm</a>()</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="keywordflow">if</span> (this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#ac6234db8eca55ca418b5043365bfdec3">HasCrmUserSession</a>)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                <span class="keywordflow">if</span> (this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a39b94d49b9c74978998cf0dd0e14edf0">SelectedEmails</a>.Any())</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                DoOrLogError( () =&gt; </div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_dialogs_1_1_archive_dialog.html">ArchiveDialog</a>(this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a39b94d49b9c74978998cf0dd0e14edf0">SelectedEmails</a>, <a class="code" href="namespace_suite_c_r_m_client_1_1_email.html#a131b90233b43196ca9cef88f2bfb3d6d">EmailArchiveReason</a>.Manual).ShowDialog());</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                MessageBox.Show(<span class="stringliteral">&quot;Please wait: SuiteSRM AddIn has not yet completed connections&quot;</span>,</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                    <span class="stringliteral">&quot;Waiting for connection&quot;</span>,</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                    MessageBoxButtons.OK);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        }</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00584"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a3d3136423943e3e4f71d3ea2b1062147">  584</a></span>&#160;        <span class="keyword">internal</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a3d3136423943e3e4f71d3ea2b1062147">ManualArchive</a>()</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#ac6234db8eca55ca418b5043365bfdec3">HasCrmUserSession</a>)</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8052836bf64ac24c9334d6ac28ec967e">ShowArchiveForm</a>();</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                MessageBox.Show(<span class="stringliteral">&quot;Please wait: SuiteSRM AddIn has not yet completed connections&quot;</span>,</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                    <span class="stringliteral">&quot;Waiting for connection&quot;</span>,</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                    MessageBoxButtons.OK);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        }</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> ThisAddIn_Quit()</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">string</span> methodName = <span class="stringliteral">&quot;ThisAddIn_Quit&quot;</span>;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Info(catalogue.GetString(<span class="stringliteral">&quot;{0}: signalled to quit.&quot;</span>, methodName));</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            this.ShutdownAll();</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            log.Info(catalogue.GetString(<span class="stringliteral">&quot;{0}: shutdown complete.&quot;</span>, methodName));</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> ThisAddIn_Shutdown(<span class="keywordtype">object</span> sender, <a class="code" href="namespace_system.html">System</a>.EventArgs e)</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">string</span> methodName = <span class="stringliteral">&quot;ThisAddIn_Shutdown&quot;</span>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Info(catalogue.GetString(<span class="stringliteral">&quot;{0}: shutting down normally.&quot;</span>, methodName));</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            ShutdownAll();</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            log.Info(catalogue.GetString(<span class="stringliteral">&quot;{0}: shutdown complete.&quot;</span>, methodName));</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> ShutdownAll()</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            {</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <span class="keywordflow">if</span> (this.CommandBarExists(<span class="stringliteral">&quot;SuiteCRM&quot;</span>))</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                {</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Info(catalogue.GetString(<span class="stringliteral">&quot;{0}: Removing SuiteCRM command bar&quot;</span>, <span class="stringliteral">&quot;ThisAddIn_ShutdownAll&quot;</span>));</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                    this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a89f35eb63bc93448017eeda72408096e">objSuiteCRMMenuBar2007</a>.Delete();</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                }</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                this.UnregisterEvents();</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_manager.html">SyncStateManager</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_manager.html#a449408102ad970c15d3df7641fafcab2">Instance</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_manager.html#a6e1782c610f0a61313e42209214e2129">BruteForceSaveAll</a>();</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                this.ShutdownProcesses();</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a91947c0f74700ebb78a18258279fe8a4">SuiteCRMUserSession</a> != null)</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a91947c0f74700ebb78a18258279fe8a4">SuiteCRMUserSession</a>.<a class="code" href="class_suite_c_r_m_client_1_1_user_session.html#a61cf62b4a67202acf08a834cbe44c5ab">LogOut</a>();</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                DisposeOf(callSynchroniser);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                DisposeOf(contactSynchroniser);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                DisposeOf(meetingSynchroniser);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                DisposeOf(taskSynchroniser);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            {</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                log.Error(<span class="stringliteral">&quot;ThisAddIn.ThisAddIn_Shutdown&quot;</span>, ex);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            }</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        }</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> ShutdownProcesses()</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            <span class="keywordtype">int</span> stillToDo = <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process.html">RepeatingProcess</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process.html#aa335ddd9d301cfa4c127e795ec5beeb5">PrepareShutdownAll</a>(this.log);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="keywordflow">if</span> (stillToDo != 0)</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            {</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_dialogs_1_1_shutting_down_dialog.html">ShuttingDownDialog</a>(stillToDo, this.log).ShowDialog();</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            }</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            log.Debug(catalogue.GetString(<span class="stringliteral">&quot;ShutdownProcesses: complete&quot;</span>));</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> UnregisterEvents()</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        {</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">string</span> methodName = <span class="stringliteral">&quot;ThisAddIn.UnregisterEvents&quot;</span>;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            {</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Info(catalogue.GetString(<span class="stringliteral">&quot;{0}: Removing context menu display event handler&quot;</span>, methodName));</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a01bdbe5957bd96dfaf5845461aff26e8">Application</a>.ItemContextMenuDisplay -=</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                    <span class="keyword">new</span> <a class="code" href="namespace_outlook.html">Outlook</a>.ApplicationEvents_11_ItemContextMenuDisplayEventHandler(this.Application_ItemContextMenuDisplay);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            }</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            {</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                log.Error(methodName, ex);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            }</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            UnregisterButtonClickHandler(this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a4b3b3ac7e3fcfa7ec447a4729be4ee4f">btnArchive</a>, this.cbtnArchive_Click);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            UnregisterButtonClickHandler(this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a52d06a085d6217241ad5d444bec7188d">btnSettings</a>, this.cbtnSettings_Click);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Info(catalogue.GetString(<span class="stringliteral">&quot;{0}: Removing new mail event handler&quot;</span>, methodName));</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                <a class="code" href="namespace_outlook.html">Outlook</a>.ApplicationEvents_11_NewMailExEventHandler handler =</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                    <span class="keyword">new</span> <a class="code" href="namespace_outlook.html">Outlook</a>.ApplicationEvents_11_NewMailExEventHandler(this.Application_NewMail);</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                <span class="keywordflow">if</span> (handler != null)</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                {</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                    this.objExplorer.Application.NewMailEx -= handler;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                }</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            }</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                log.Error(methodName, ex);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            }</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Info(catalogue.GetString(<span class="stringliteral">&quot;{0}: Removing archive item send event handler&quot;</span>, methodName));</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                this.objExplorer.Application.ItemSend -= <span class="keyword">new</span> <a class="code" href="namespace_outlook.html">Outlook</a>.ApplicationEvents_11_ItemSendEventHandler(this.Application_ItemSend);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                log.Error(methodName, ex);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            }</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> UnregisterButtonClickHandler(CommandBarButton button, _CommandBarButtonEvents_ClickEventHandler clickHandler)</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        {</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            <span class="keywordtype">string</span> methodName = <span class="stringliteral">&quot;ThisAddIn.UnregisterButtonClickHandler&quot;</span>;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            <span class="keywordflow">if</span> (button != null)</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            {</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Info(catalogue.GetString(<span class="stringliteral">&quot;{0}: Removing archive button click event handler&quot;</span>, methodName));</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                    button.Click -= <span class="keyword">new</span> <a class="code" href="namespace_office.html">Office</a>._CommandBarButtonEvents_ClickEventHandler(clickHandler);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                }</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                {</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                    log.Error(methodName, ex);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                }</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            }</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> DisposeOf(IDisposable toDispose)</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="keywordtype">string</span> methodName = <span class="stringliteral">&quot;ThisAddIn.DisposeOf&quot;</span>;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            <span class="keywordflow">if</span> (toDispose != null)</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            {</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                {</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Debug(catalogue.GetString(<span class="stringliteral">&quot;{0}: Disposing of {1}&quot;</span>, methodName, toDispose.GetType().Name));</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                    toDispose.Dispose();</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                }</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                {</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                    log.Error(catalogue.GetString(<span class="stringliteral">&quot;{0}: Failed to dispose of instance of {1}&quot;</span>, methodName, toDispose.GetType().Name), ex);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                log.Error(catalogue.GetString(<span class="stringliteral">&quot;{0}: Attempt to dispose of null reference?&quot;</span>, methodName));</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            }</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        }</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> CommandBarExists(<span class="keywordtype">string</span> name)</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        {</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                var explorer = <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a01bdbe5957bd96dfaf5845461aff26e8">Application</a>.ActiveExplorer();</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                <span class="keywordflow">return</span> (explorer != null &amp;&amp; explorer.CommandBars[name] != null);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_system.html">System</a>.Exception)</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            {</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            }</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        }</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="preprocessor">        #region VSTO generated code</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> Application_ItemContextMenuDisplay(<a class="code" href="namespace_office.html">Office</a>.CommandBar CommandBar, <a class="code" href="namespace_outlook.html">Outlook</a>.Selection Selection)</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            {</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                <a class="code" href="namespace_outlook.html">Outlook</a>.Selection selection = Selection;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                <a class="code" href="namespace_outlook.html">Outlook</a>.MailItem item1 = (<a class="code" href="namespace_outlook.html">Outlook</a>.MailItem)selection[1];</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                <a class="code" href="namespace_office.html">Office</a>.CommandBarButton objMainMenu = (<a class="code" href="namespace_office.html">Office</a>.CommandBarButton)CommandBar.Controls.Add(Microsoft.Office.Core.MsoControlType.msoControlButton, <span class="keyword">this</span>.missing, <span class="keyword">this</span>.missing, <span class="keyword">this</span>.missing, <span class="keyword">this</span>.missing);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                objMainMenu.Caption = catalogue.GetString(<span class="stringliteral">&quot;SuiteCRM Archive&quot;</span>);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                objMainMenu.Visible = <span class="keyword">true</span>;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                objMainMenu.Picture = <a class="code" href="class_suite_c_r_m_add_in_1_1_ribbon_image_helper.html">RibbonImageHelper</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_ribbon_image_helper.html#ab6c37f7066ccafd90143fe3803cb3c8b">Convert</a>(<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_resources.html">Resources</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_resources.html#a186368c19174d13c48724c8d5b6cd39b">SuiteCRMLogo</a>);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                objMainMenu.Click += <span class="keyword">new</span> <a class="code" href="namespace_office.html">Office</a>._CommandBarButtonEvents_ClickEventHandler(this.contextMenuArchiveButton_Click);</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            }</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a>)</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            {</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            }</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        }</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> contextMenuArchiveButton_Click(<a class="code" href="namespace_office.html">Office</a>.CommandBarButton Ctrl, ref <span class="keywordtype">bool</span> CancelDefault)</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        {</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            DoOrLogError(() =&gt;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#ac6234db8eca55ca418b5043365bfdec3">HasCrmUserSession</a>)</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                {</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8e4511bd9e35cdd0b86024d96341990b">ShowSettingsForm</a>();</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                }</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8052836bf64ac24c9334d6ac28ec967e">ShowArchiveForm</a>();</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            });</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        }</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> Application_ItemSend(<span class="keywordtype">object</span> item, ref <span class="keywordtype">bool</span> target)</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        {</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            log.Debug(catalogue.GetString(<span class="stringliteral">&quot;Outlook ItemSend: email sent event&quot;</span>));</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            {</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                <span class="keywordflow">if</span> (this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aff2091c03ba97186e5d01f74806bd63a">IsLicensed</a> &amp;&amp; Properties.Settings.Default.AutoArchive)</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                    ProcessNewMailItem(</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                        <a class="code" href="namespace_suite_c_r_m_client_1_1_email.html#a131b90233b43196ca9cef88f2bfb3d6d">EmailArchiveReason</a>.Outbound,</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                        item as <a class="code" href="namespace_outlook.html">Outlook</a>.MailItem,</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                        Properties.Settings.Default.ExcludedEmails);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            }</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            {</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_error_handler.html">ErrorHandler</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_error_handler.html#aa5ac5699b0099c7a812a895751df5e07">Handle</a>(catalogue.GetString(<span class="stringliteral">&quot;Failed while trying to handle a sent email&quot;</span>), ex);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            }</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        }</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> Application_NewMail(<span class="keywordtype">string</span> EntryID)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        {</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            log.Debug(catalogue.GetString(<span class="stringliteral">&quot;Outlook NewMail: email received event&quot;</span>));</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                <span class="keywordflow">if</span> (this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aff2091c03ba97186e5d01f74806bd63a">IsLicensed</a>)</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                {</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                    var item = <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a01bdbe5957bd96dfaf5845461aff26e8">Application</a>.Session.GetItemFromID(EntryID);</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                    <span class="keywordflow">if</span> (item is <a class="code" href="namespace_outlook.html">Outlook</a>.MailItem &amp;&amp; Properties.Settings.Default.AutoArchive)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                    {</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                        ProcessNewMailItem(<a class="code" href="namespace_suite_c_r_m_client_1_1_email.html#a131b90233b43196ca9cef88f2bfb3d6d">EmailArchiveReason</a>.Inbound,</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                                            item as <a class="code" href="namespace_outlook.html">Outlook</a>.MailItem,</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                            <a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html">Settings</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a906a8cf6ad39360af6fcb416ada8068c">Default</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a50d10ee7eabe83fb782982a158734170">ExcludedEmails</a>);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                    }</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (item is <a class="code" href="namespace_outlook.html">Outlook</a>.MeetingItem &amp;&amp; <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html">SyncDirection</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html#ad456cb19bab5eb78bc35f7b305274d01">AllowOutbound</a>(Properties.Settings.Default.SyncMeetings))</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                    {</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                        ProcessNewMeetingItem(item as <a class="code" href="namespace_outlook.html">Outlook</a>.MeetingItem);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                    }</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                }</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            }</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            {</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_error_handler.html">ErrorHandler</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_error_handler.html#aa5ac5699b0099c7a812a895751df5e07">Handle</a>(catalogue.GetString(<span class="stringliteral">&quot;Failed while trying to handle a received email&quot;</span>), ex);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            }</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        }</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> ProcessNewMeetingItem(<a class="code" href="namespace_outlook.html">Outlook</a>.MeetingItem meetingItem)</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        {</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <span class="keywordtype">string</span> vCalId = meetingItem.GetVCalId();</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_crm_id.html">CrmId</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_crm_id.html#ae8a022a1d7034b495864a55ede1e0e72">IsValid</a>(vCalId) &amp;&amp; <a class="code" href="class_suite_c_r_m_client_1_1_rest_a_p_i_wrapper.html">RestAPIWrapper</a>.<a class="code" href="class_suite_c_r_m_client_1_1_rest_a_p_i_wrapper.html#ad67beabea121917433d6439617a7ef32">GetEntry</a>(MeetingsSynchroniser.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_meetings_synchroniser.html#a3feecd7b6d39a556a71f9fe7a3ea93c7">DefaultCrmModule</a>, vCalId, <span class="keyword">new</span> <span class="keywordtype">string</span>[] { <span class="stringliteral">&quot;id&quot;</span> }) != null)</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            {</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                meetingItem.GetAssociatedAppointment(<span class="keyword">false</span>).SetCrmId(<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_crm_id.html">CrmId</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_crm_id.html#a4c42d534f0f83aa65403c2c8e06dc5d1">Get</a>(vCalId));</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            }</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> ProcessNewMailItem(<a class="code" href="namespace_suite_c_r_m_client_1_1_email.html#a131b90233b43196ca9cef88f2bfb3d6d">EmailArchiveReason</a> archiveType, <a class="code" href="namespace_outlook.html">Outlook</a>.MailItem mailItem, <span class="keywordtype">string</span> excludedEmails = <span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        {</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="keywordtype">bool</span> result;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="keywordflow">if</span> (mailItem == null)</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            {</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                log.Info(catalogue.GetString(<span class="stringliteral">&quot;New &#39;mail item&#39; was null&quot;</span>));</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                result = <span class="keyword">false</span>;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            }</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            {</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                this.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a059ba6330fe696daba3c216994fd5fc7">EmailArchiver</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_email_archiving.html#a28d7941e33b094c344e5691a1a6be644">ProcessEligibleNewMailItem</a>(mailItem, archiveType, excludedEmails);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                result = <span class="keyword">true</span>;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            }</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        }</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> InternalStartup()</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        {</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            this.Startup += <span class="keyword">new</span> <a class="code" href="namespace_system.html">System</a>.EventHandler(ThisAddIn_Startup);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            this.Shutdown += <span class="keyword">new</span> <a class="code" href="namespace_system.html">System</a>.EventHandler(ThisAddIn_Shutdown);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        }</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="preprocessor">        #endregion</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a48d2a3cf3d5ce8cb7c3430b59caeb4d9">  899</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> Microsoft.Office.Core.IRibbonExtensibility <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a48d2a3cf3d5ce8cb7c3430b59caeb4d9">CreateRibbonExtensibilityObject</a>()</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        {</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_suite_c_r_m_ribbon.html">SuiteCRMRibbon</a>();</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        }</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a7079a786abcf4e8a54fe271e79838ff1">SuiteCRMAuthenticate</a>() =&gt; <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#ac6234db8eca55ca418b5043365bfdec3">HasCrmUserSession</a> ? true : <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aee77aec45c87898261c4ca5f91ae2476">Authenticate</a>();</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aee77aec45c87898261c4ca5f91ae2476">  910</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aee77aec45c87898261c4ca5f91ae2476">Authenticate</a>() {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aee77aec45c87898261c4ca5f91ae2476">Authenticate</a>(Properties.Settings.Default.Host,</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                    Properties.Settings.Default.Username,</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                    Properties.Settings.Default.Password,</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                    Properties.Settings.Default.LDAPKey);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        }</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00925"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a9d0e15278e7570ae6acc60ed081d7bdb">  925</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a9d0e15278e7570ae6acc60ed081d7bdb">Authenticate</a>(<span class="keywordtype">string</span> host, <span class="keywordtype">string</span> username, <span class="keywordtype">string</span> password, <span class="keywordtype">string</span> ldapKey)</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        {</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            {</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                <span class="keywordflow">if</span> (Properties.Settings.Default.Host != String.Empty)</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                {</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a29a3f70d27e47811fe557d2d8a2cad8a">ReinitialiseSession</a>(host, username, password, ldapKey);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    <span class="keywordflow">try</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                    {</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a91947c0f74700ebb78a18258279fe8a4">SuiteCRMUserSession</a>.<a class="code" href="class_suite_c_r_m_client_1_1_user_session.html#ab87c129239b75b804deeba8f16150968">Login</a>())</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                        {</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                            LogServerVersion();</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                            result = <span class="keyword">true</span>;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                        }</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                    }</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                    <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> any)</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                    {</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                        <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Error(<span class="stringliteral">&quot;Failure while trying to authenticate to CRM&quot;</span>, any);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                    }</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                }</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                {</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                    <span class="comment">// We don&#39;t have a URL to connect to, dummy the connection.</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a91947c0f74700ebb78a18258279fe8a4">SuiteCRMUserSession</a> =</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                        <span class="keyword">new</span> <a class="code" href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a>.<a class="code" href="class_suite_c_r_m_client_1_1_user_session.html">UserSession</a>(</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                            String.Empty,</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                            String.Empty,</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                            String.Empty,</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                            String.Empty,</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                            <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html">ThisAddIn</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a078b072a3e77ab54327124942b24db2d">AddInTitle</a>,</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                            log,</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                            Properties.Settings.Default.RestTimeout);</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                }</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            }</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            {</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Error(<span class="stringliteral">&quot;ThisAddIn.Authenticate&quot;</span>, ex);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            }</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        }</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a29a3f70d27e47811fe557d2d8a2cad8a">  973</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a29a3f70d27e47811fe557d2d8a2cad8a">ReinitialiseSession</a>(<span class="keywordtype">string</span> host, <span class="keywordtype">string</span> username, <span class="keywordtype">string</span> password, <span class="keywordtype">string</span> ldapKey)</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        {</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a91947c0f74700ebb78a18258279fe8a4">SuiteCRMUserSession</a> = <span class="keyword">new</span> <a class="code" href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a>.<a class="code" href="class_suite_c_r_m_client_1_1_user_session.html">UserSession</a>(host, username, password, ldapKey,</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html">ThisAddIn</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a078b072a3e77ab54327124942b24db2d">AddInTitle</a>,</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                log,</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                Properties.Settings.Default.RestTimeout);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        }</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> LogServerVersion()</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        {</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1_server_info.html">ServerInfo</a> info = <a class="code" href="class_suite_c_r_m_client_1_1_rest_a_p_i_wrapper.html">RestAPIWrapper</a>.<a class="code" href="class_suite_c_r_m_client_1_1_rest_a_p_i_wrapper.html#a68ac5a7ecc6526184d1d156354b87ead">GetServerInfo</a>();</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            <span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrWhiteSpace(info.<a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1_server_info.html#a9d7cbb93541e6ed072d1ed61a8049fff">SuiteCRMVersion</a>))</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            {</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                log.Info($<span class="stringliteral">&quot;Connected to an instance of SuiteCRM version {info.SuiteCRMVersion}.&quot;</span>);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            }</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrWhiteSpace(info.<a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1_server_info.html#a5a1474302396d208e5a4e8b51fa1ade9">SugarVersion</a>))</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            {</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                log.Info($<span class="stringliteral">&quot;Connected to an instance of Sugar version {info.SugarVersion}.&quot;</span>);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            }</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a9081d833c94c4f85712c247d34dae5aa">  998</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a9081d833c94c4f85712c247d34dae5aa">SelectedEmailCount</a> =&gt; <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a01bdbe5957bd96dfaf5845461aff26e8">Application</a>.ActiveExplorer()?.Selection.Count ?? 0;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <span class="keyword">public</span> IEnumerable&lt;<a class="code" href="namespace_outlook.html">Outlook</a>.MailItem&gt; <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a39b94d49b9c74978998cf0dd0e14edf0">SelectedEmails</a></div><div class="line"><a name="l01001"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a39b94d49b9c74978998cf0dd0e14edf0"> 1001</a></span>&#160;        {</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            <span class="keyword">get</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            {</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                var selection = <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a01bdbe5957bd96dfaf5845461aff26e8">Application</a>.ActiveExplorer()?.Selection;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                <span class="keywordflow">if</span> (selection == null) yield <span class="keywordflow">break</span>;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                <span class="keywordflow">foreach</span> (<span class="keywordtype">object</span> e <span class="keywordflow">in</span> selection)</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                {</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                    var mail = e as <a class="code" href="namespace_outlook.html">Outlook</a>.MailItem;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                    <span class="keywordflow">if</span> (mail != null) yield <span class="keywordflow">return</span> mail;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                    Marshal.ReleaseComObject(e);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                }</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            }</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        }</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="keyword">public</span> IEnumerable&lt;<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem&gt; <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a0cb1559d67fa90a6f9a7e423e9e6d0fd">SelectedContacts</a></div><div class="line"><a name="l01016"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a0cb1559d67fa90a6f9a7e423e9e6d0fd"> 1016</a></span>&#160;        {</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            <span class="keyword">get</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            {</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                var selection = <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a01bdbe5957bd96dfaf5845461aff26e8">Application</a>.ActiveExplorer()?.Selection;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                <span class="keywordflow">if</span> (selection == null) yield <span class="keywordflow">break</span>;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                <span class="keywordflow">foreach</span> (<span class="keywordtype">object</span> e <span class="keywordflow">in</span> selection)</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                {</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                    var contact = e as <a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                    <span class="keywordflow">if</span> (contact != null) yield <span class="keywordflow">return</span> contact;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                    Marshal.ReleaseComObject(e);</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                }</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            }</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        }</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div><div class="line"><a name="l01034"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aff2091c03ba97186e5d01f74806bd63a"> 1034</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aff2091c03ba97186e5d01f74806bd63a">IsLicensed</a> { <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; } = <span class="keyword">false</span>;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">void</span> GetTitleAndVersion(out <span class="keywordtype">string</span> title, out <span class="keywordtype">string</span> versionString)</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        {</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            var assembly = Assembly.GetExecutingAssembly();</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            var name = assembly.GetName();</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;            var version = name.Version;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            title = (assembly.GetCustomAttributes(typeof(AssemblyTitleAttribute)).SingleOrDefault() as</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                        AssemblyTitleAttribute)?.Title</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                    ?? name.Name;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            <span class="comment">// &#39;Build&#39; is what we&#39;d call the &#39;revision number&#39; and</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            <span class="comment">// &#39;Revision&#39; is what we&#39;d call the &#39;build number&#39;.</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            versionString = $<span class="stringliteral">&quot;{version.Major}.{version.Minor}.{version.Build}.{version.Revision}&quot;</span>;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        }</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> DoOrLogError(Action action)</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        {</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_robustness.html">Robustness</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_robustness.html#a1c4263fa0ac98393772c3dec7d97a0af">DoOrLogError</a>(log, action);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        }</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> DoOrLogError(Action action, <span class="keywordtype">string</span> message)</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        {</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_robustness.html">Robustness</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_robustness.html#a1c4263fa0ac98393772c3dec7d97a0af">DoOrLogError</a>(log, action, message);</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        }</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01061"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8f019e8cd74b651865a318ef26ceb30f"> 1061</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8f019e8cd74b651865a318ef26ceb30f">ShowAndLogError</a>(<a class="code" href="namespace_exception.html">Exception</a> error, <span class="keywordtype">string</span> message, <span class="keywordtype">string</span> summary)</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        {</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            MessageBox.Show(</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                message,</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                summary,</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                MessageBoxButtons.OK,</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                MessageBoxIcon.Warning);</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">Log</a>.Error(summary, error);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        }</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a667c806625d781a8d528bae58347c113"> 1075</a></span>&#160;        <span class="keyword">internal</span> <span class="keywordtype">int</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a667c806625d781a8d528bae58347c113">CountItems</a>()</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        {</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_manager.html">SyncStateManager</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_manager.html#a449408102ad970c15d3df7641fafcab2">Instance</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_manager.html#aca32dffb3e78093659e983544c33290f">CountItems</a>();</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        }</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a096883436afdc359db036a8bdec9c9aa"> 1085</a></span>&#160;        <span class="keyword">internal</span> IEnumerable&lt;WithRemovableSynchronisationProperties&gt; <a class="code" href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a096883436afdc359db036a8bdec9c9aa">GetSynchronisableItems</a>()</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        {</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            List&lt;WithRemovableSynchronisationProperties&gt; result = <span class="keyword">new</span> List&lt;WithRemovableSynchronisationProperties&gt;();</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            <span class="keywordflow">if</span> (this.callSynchroniser != null)</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            {</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                result.AddRange(this.callSynchroniser.GetSynchronisedItems());</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            }</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            <span class="keywordflow">if</span> (this.contactSynchroniser != null)</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            {</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                result.AddRange(this.contactSynchroniser.GetSynchronisedItems());</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            }</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            <span class="keywordflow">if</span> (this.meetingSynchroniser != null)</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            {</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                result.AddRange(this.meetingSynchroniser.GetSynchronisedItems());</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            }</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            <span class="keywordflow">if</span> (this.taskSynchroniser != null)</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            {</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                result.AddRange(this.taskSynchroniser.GetSynchronisedItems());</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            }</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <span class="keywordflow">return</span> result;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        }</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    }</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;}</div><div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_meetings_synchroniser_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_meetings_synchroniser.html">SuiteCRMAddIn.BusinessLogic.MeetingsSynchroniser</a></div><div class="ttdef"><b>Definition:</b> <a href="_meetings_synchroniser_8cs_source.html#l00036">MeetingsSynchroniser.cs:36</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process.html">SuiteCRMAddIn.BusinessLogic.RepeatingProcess</a></div><div class="ttdoc">An agent which does something repeatedly. </div><div class="ttdef"><b>Definition:</b> <a href="_repeating_process_8cs_source.html#l00036">RepeatingProcess.cs:36</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1_rest_a_p_i_wrapper_html"><div class="ttname"><a href="class_suite_c_r_m_client_1_1_rest_a_p_i_wrapper.html">SuiteCRMClient.RestAPIWrapper</a></div><div class="ttdoc">A class which comprises wrappers for calls in the REST API, which return objects generally from the R...</div><div class="ttdef"><b>Definition:</b> <a href="_rest_a_p_i_wrapper_8cs_source.html#l00039">RestAPIWrapper.cs:39</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a39b94d49b9c74978998cf0dd0e14edf0"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a39b94d49b9c74978998cf0dd0e14edf0">SuiteCRMAddIn.ThisAddIn.SelectedEmails</a></div><div class="ttdeci">IEnumerable&lt; Outlook.MailItem &gt; SelectedEmails</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l01001">ThisAddIn.cs:1001</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_crm_id_html_a4c42d534f0f83aa65403c2c8e06dc5d1"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_crm_id.html#a4c42d534f0f83aa65403c2c8e06dc5d1">SuiteCRMAddIn.BusinessLogic.CrmId.Get</a></div><div class="ttdeci">static CrmId Get(string value)</div><div class="ttdoc">Get the single CrmId instance for this value. </div><div class="ttdef"><b>Definition:</b> <a href="_crm_id_8cs_source.html#l00153">CrmId.cs:153</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a8052836bf64ac24c9334d6ac28ec967e"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8052836bf64ac24c9334d6ac28ec967e">SuiteCRMAddIn.ThisAddIn.ShowArchiveForm</a></div><div class="ttdeci">void ShowArchiveForm()</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00566">ThisAddIn.cs:566</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a0e2dbad2cebfd48a2db67c4b9f22d2b3"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a0e2dbad2cebfd48a2db67c4b9f22d2b3">SuiteCRMAddIn.ThisAddIn.DeferredStartup</a></div><div class="ttdeci">void DeferredStartup()</div><div class="ttdoc">Actually perform the startup of all the addin&amp;#39;s services. </div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00149">ThisAddIn.cs:149</a></div></div>
<div class="ttc" id="namespace_outlook_html"><div class="ttname"><a href="namespace_outlook.html">Outlook</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_ac6234db8eca55ca418b5043365bfdec3"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#ac6234db8eca55ca418b5043365bfdec3">SuiteCRMAddIn.ThisAddIn.HasCrmUserSession</a></div><div class="ttdeci">bool HasCrmUserSession</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00131">ThisAddIn.cs:131</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context_html_a09c4d2acefef124035da888b7a469313"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context.html#a09c4d2acefef124035da888b7a469313">SuiteCRMAddIn.BusinessLogic.SyncContext.SetCurrentFolder</a></div><div class="ttdeci">void SetCurrentFolder(Outlook.MAPIFolder folder)</div><div class="ttdef"><b>Definition:</b> <a href="_sync_context_8cs_source.html#l00048">SyncContext.cs:48</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1_server_info_html_a5a1474302396d208e5a4e8b51fa1ade9"><div class="ttname"><a href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1_server_info.html#a5a1474302396d208e5a4e8b51fa1ade9">SuiteCRMClient.RESTObjects.ServerInfo.SugarVersion</a></div><div class="ttdeci">string SugarVersion</div><div class="ttdoc">Version of SugarCRM on which this version of SuiteCRM is based. </div><div class="ttdef"><b>Definition:</b> <a href="_server_info_8cs_source.html#l00042">ServerInfo.cs:42</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_manager_html_a6e1782c610f0a61313e42209214e2129"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_manager.html#a6e1782c610f0a61313e42209214e2129">SuiteCRMAddIn.BusinessLogic.SyncStateManager.BruteForceSaveAll</a></div><div class="ttdeci">void BruteForceSaveAll()</div><div class="ttdoc">This is part of an attempt to stop the &amp;#39;do you want to save&amp;#39; popups; save everything we&amp;#39;ve touched...</div><div class="ttdef"><b>Definition:</b> <a href="_sync_state_manager_8cs_source.html#l00153">SyncStateManager.cs:153</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_client_1_1_email_html_a131b90233b43196ca9cef88f2bfb3d6d"><div class="ttname"><a href="namespace_suite_c_r_m_client_1_1_email.html#a131b90233b43196ca9cef88f2bfb3d6d">SuiteCRMClient.Email.EmailArchiveReason</a></div><div class="ttdeci">EmailArchiveReason</div><div class="ttdoc">An enumeration of reasons why an email may be archived. </div><div class="ttdef"><b>Definition:</b> <a href="_email_archive_reason_8cs_source.html#l00028">EmailArchiveReason.cs:28</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1_user_session_html_ab87c129239b75b804deeba8f16150968"><div class="ttname"><a href="class_suite_c_r_m_client_1_1_user_session.html#ab87c129239b75b804deeba8f16150968">SuiteCRMClient.UserSession.Login</a></div><div class="ttdeci">bool Login()</div><div class="ttdoc">Logs in to the CRM server. </div><div class="ttdef"><b>Definition:</b> <a href="_user_session_8cs_source.html#l00091">UserSession.cs:91</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_helpers_1_1_licence_validation_helper_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_helpers_1_1_licence_validation_helper.html">SuiteCRMAddIn.Helpers.LicenceValidationHelper</a></div><div class="ttdoc">A helper to do licence validation. See documentation at https://store.suitecrm.com/selling/license-ap...</div><div class="ttdef"><b>Definition:</b> <a href="_licence_validation_helper_8cs_source.html#l00036">LicenceValidationHelper.cs:36</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1_server_info_html"><div class="ttname"><a href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1_server_info.html">SuiteCRMClient.RESTObjects.ServerInfo</a></div><div class="ttdoc">An object returned by the get_server_info call. </div><div class="ttdef"><b>Definition:</b> <a href="_server_info_8cs_source.html#l00030">ServerInfo.cs:30</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_synchroniser_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_synchroniser.html">SuiteCRMAddIn.BusinessLogic.ContactSynchroniser</a></div><div class="ttdoc">An agent which synchronises Outlook Contact items with CRM. </div><div class="ttdef"><b>Definition:</b> <a href="_contact_synchroniser_8cs_source.html#l00040">ContactSynchroniser.cs:40</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_daemon_1_1_fetch_email_categories_action_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_daemon_1_1_fetch_email_categories_action.html">SuiteCRMAddIn.Daemon.FetchEmailCategoriesAction</a></div><div class="ttdoc">The idea here is that at startup, the addin fires off one instance of this action, passing in its (initially empty) list of email categories by reference. When this action runs, it populates that list, so that if the email archiving dialogue is subsequently opened, it has the appropriate values. </div><div class="ttdef"><b>Definition:</b> <a href="_fetch_email_categories_action_8cs_source.html#l00039">FetchEmailCategoriesAction.cs:39</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a7c85364b85b111f650f55b5c2e090e0c"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a7c85364b85b111f650f55b5c2e090e0c">SuiteCRMAddIn.ThisAddIn.RibbonUI</a></div><div class="ttdeci">Office.IRibbonUI RibbonUI</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00084">ThisAddIn.cs:84</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_afbf26faf3e59aa086fddc4b13fb62793"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#afbf26faf3e59aa086fddc4b13fb62793">SuiteCRMAddIn.ThisAddIn.catalogue</a></div><div class="ttdeci">ICatalog catalogue</div><div class="ttdoc">Internationalisation (118n) strings dictionary </div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00082">ThisAddIn.cs:82</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_email_archiving_html_a28d7941e33b094c344e5691a1a6be644"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_email_archiving.html#a28d7941e33b094c344e5691a1a6be644">SuiteCRMAddIn.BusinessLogic.EmailArchiving.ProcessEligibleNewMailItem</a></div><div class="ttdeci">void ProcessEligibleNewMailItem(Outlook.MailItem olItem, EmailArchiveReason reason, string excludedEmails=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="_email_archiving_8cs_source.html#l00194">EmailArchiving.cs:194</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a52d06a085d6217241ad5d444bec7188d"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a52d06a085d6217241ad5d444bec7188d">SuiteCRMAddIn.ThisAddIn.btnSettings</a></div><div class="ttdeci">Office.CommandBarButton btnSettings</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00059">ThisAddIn.cs:59</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_suite_c_r_m_ribbon_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_suite_c_r_m_ribbon.html">SuiteCRMAddIn.SuiteCRMRibbon</a></div><div class="ttdoc">Code for our user interfave (ribbon, context menus) items. See also MailRead.xml and MailRead2007...</div><div class="ttdef"><b>Definition:</b> <a href="_suite_c_r_m_ribbon_8cs_source.html#l00060">SuiteCRMRibbon.cs:60</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a078b072a3e77ab54327124942b24db2d"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a078b072a3e77ab54327124942b24db2d">SuiteCRMAddIn.ThisAddIn.AddInTitle</a></div><div class="ttdeci">static readonly string AddInTitle</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00053">ThisAddIn.cs:53</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_properties_1_1_settings_html_a70a256c8149998293464ae1c47294fd4"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a70a256c8149998293464ae1c47294fd4">SuiteCRMAddIn.Properties.Settings.NeedsUpgrade</a></div><div class="ttdeci">bool NeedsUpgrade</div><div class="ttdef"><b>Definition:</b> <a href="_suite_c_r_m_add_in_2_properties_2_settings_8_designer_8cs_source.html#l00324">Settings.Designer.cs:324</a></div></div>
<div class="ttc" id="namespace_system_html"><div class="ttname"><a href="namespace_system.html">System</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a7079a786abcf4e8a54fe271e79838ff1"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a7079a786abcf4e8a54fe271e79838ff1">SuiteCRMAddIn.ThisAddIn.SuiteCRMAuthenticate</a></div><div class="ttdeci">bool SuiteCRMAuthenticate()</div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_dialogs_1_1_manual_sync_contact_form_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_dialogs_1_1_manual_sync_contact_form.html">SuiteCRMAddIn.Dialogs.ManualSyncContactForm</a></div><div class="ttdef"><b>Definition:</b> <a href="_manual_sync_contact_form_8cs_source.html#l00043">ManualSyncContactForm.cs:43</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_ribbon_image_helper_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_ribbon_image_helper.html">SuiteCRMAddIn.RibbonImageHelper</a></div><div class="ttdef"><b>Definition:</b> <a href="_ribbon_image_helper_8cs_source.html#l00029">RibbonImageHelper.cs:29</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a70c456ec8f2b1eb795b29e2787f56ea4"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70c456ec8f2b1eb795b29e2787f56ea4">SuiteCRMAddIn.ThisAddIn.Log</a></div><div class="ttdeci">ILogger Log</div><div class="ttdoc">Property to allow other classes to get the logger object, but not replace it with a new logger object...</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00098">ThisAddIn.cs:98</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_helpers_1_1_licence_validation_helper_html_ad940fcca799f5eb17338aa71ee8a3753"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_helpers_1_1_licence_validation_helper.html#ad940fcca799f5eb17338aa71ee8a3753">SuiteCRMAddIn.Helpers.LicenceValidationHelper.Validate</a></div><div class="ttdeci">bool Validate()</div><div class="ttdoc">Validate my key pair. </div><div class="ttdef"><b>Definition:</b> <a href="_licence_validation_helper_8cs_source.html#l00103">LicenceValidationHelper.cs:103</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process_html_aa335ddd9d301cfa4c127e795ec5beeb5"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process.html#aa335ddd9d301cfa4c127e795ec5beeb5">SuiteCRMAddIn.BusinessLogic.RepeatingProcess.PrepareShutdownAll</a></div><div class="ttdeci">static int PrepareShutdownAll(ILogger log)</div><div class="ttdoc">Prepare to shutdown all running processes. </div><div class="ttdef"><b>Definition:</b> <a href="_repeating_process_8cs_source.html#l00212">RepeatingProcess.cs:212</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1_rest_a_p_i_wrapper_html_a68ac5a7ecc6526184d1d156354b87ead"><div class="ttname"><a href="class_suite_c_r_m_client_1_1_rest_a_p_i_wrapper.html#a68ac5a7ecc6526184d1d156354b87ead">SuiteCRMClient.RestAPIWrapper.GetServerInfo</a></div><div class="ttdeci">static RESTObjects.ServerInfo GetServerInfo()</div><div class="ttdoc">Perform a get_server_info call, and return the result. </div><div class="ttdef"><b>Definition:</b> <a href="_rest_a_p_i_wrapper_8cs_source.html#l00507">RestAPIWrapper.cs:507</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a48d2a3cf3d5ce8cb7c3430b59caeb4d9"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a48d2a3cf3d5ce8cb7c3430b59caeb4d9">SuiteCRMAddIn.ThisAddIn.CreateRibbonExtensibilityObject</a></div><div class="ttdeci">override Microsoft.Office.Core.IRibbonExtensibility CreateRibbonExtensibilityObject()</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00899">ThisAddIn.cs:899</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_log4_net_logger_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_log4_net_logger.html">SuiteCRMAddIn.Log4NetLogger</a></div><div class="ttdef"><b>Definition:</b> <a href="_log4_net_logger_8cs_source.html#l00036">Log4NetLogger.cs:36</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_robustness_html_a1c4263fa0ac98393772c3dec7d97a0af"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_robustness.html#a1c4263fa0ac98393772c3dec7d97a0af">SuiteCRMAddIn.Robustness.DoOrLogError</a></div><div class="ttdeci">static void DoOrLogError(ILogger log, Action action)</div><div class="ttdef"><b>Definition:</b> <a href="_robustness_8cs_source.html#l00012">Robustness.cs:12</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction_html_aee195368e938ed8e05fa3ec669838c06"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html#aee195368e938ed8e05fa3ec669838c06">SuiteCRMAddIn.BusinessLogic.SyncDirection.Direction</a></div><div class="ttdeci">Direction</div><div class="ttdoc">The actual directions </div><div class="ttdef"><b>Definition:</b> <a href="_sync_direction_8cs_source.html#l00034">SyncDirection.cs:34</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_dialogs_1_1_reconfigure_or_disable_dialog_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_dialogs_1_1_reconfigure_or_disable_dialog.html">SuiteCRMAddIn.Dialogs.ReconfigureOrDisableDialog</a></div><div class="ttdoc">A simple dialog asking the user whether they wish to reconfigure or disable the add in following a li...</div><div class="ttdef"><b>Definition:</b> <a href="_reconfigure_or_disable_dialog_8cs_source.html#l00032">ReconfigureOrDisableDialog.cs:32</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_client_1_1_logging_html"><div class="ttname"><a href="namespace_suite_c_r_m_client_1_1_logging.html">SuiteCRMClient.Logging</a></div><div class="ttdef"><b>Definition:</b> <a href="_abstract_logger_8cs_source.html#l00023">AbstractLogger.cs:23</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1_user_session_html"><div class="ttname"><a href="class_suite_c_r_m_client_1_1_user_session.html">SuiteCRMClient.UserSession</a></div><div class="ttdef"><b>Definition:</b> <a href="_user_session_8cs_source.html#l00031">UserSession.cs:31</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_properties_1_1_settings_html_a906a8cf6ad39360af6fcb416ada8068c"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a906a8cf6ad39360af6fcb416ada8068c">SuiteCRMAddIn.Properties.Settings.Default</a></div><div class="ttdeci">static Settings Default</div><div class="ttdef"><b>Definition:</b> <a href="_suite_c_r_m_add_in_2_properties_2_settings_8_designer_8cs_source.html#l00020">Settings.Designer.cs:20</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1_user_session_html_a877b89070d382c035608e3ec35d97963"><div class="ttname"><a href="class_suite_c_r_m_client_1_1_user_session.html#a877b89070d382c035608e3ec35d97963">SuiteCRMClient.UserSession.IsLoggedIn</a></div><div class="ttdeci">bool IsLoggedIn</div><div class="ttdef"><b>Definition:</b> <a href="_user_session_8cs_source.html#l00048">UserSession.cs:48</a></div></div>
<div class="ttc" id="namespace_exception_html"><div class="ttname"><a href="namespace_exception.html">Exception</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1_rest_a_p_i_wrapper_html_a0ffc33bcc99b1ee4d047cff56a560216"><div class="ttname"><a href="class_suite_c_r_m_client_1_1_rest_a_p_i_wrapper.html#a0ffc33bcc99b1ee4d047cff56a560216">SuiteCRMClient.RestAPIWrapper.SetLog</a></div><div class="ttdeci">static void SetLog(ILogger log)</div><div class="ttdef"><b>Definition:</b> <a href="_rest_a_p_i_wrapper_8cs_source.html#l00066">RestAPIWrapper.cs:66</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_client_1_1_r_e_s_t_objects_html"><div class="ttname"><a href="namespace_suite_c_r_m_client_1_1_r_e_s_t_objects.html">SuiteCRMClient.RESTObjects</a></div><div class="ttdoc">The RESTObjects package contains classes which may be deserialised from JSON messages sent by CRM...</div><div class="ttdef"><b>Definition:</b> <a href="_available_modules_8cs_source.html#l00023">AvailableModules.cs:23</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_manager_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_manager.html">SuiteCRMAddIn.BusinessLogic.SyncStateManager</a></div><div class="ttdoc">One of the problems with the design of the add-in is that we&amp;#39;re trying to shim two types of CRM entit...</div><div class="ttdef"><b>Definition:</b> <a href="_sync_state_manager_8cs_source.html#l00048">SyncStateManager.cs:48</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_aff2091c03ba97186e5d01f74806bd63a"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aff2091c03ba97186e5d01f74806bd63a">SuiteCRMAddIn.ThisAddIn.IsLicensed</a></div><div class="ttdeci">bool IsLicensed</div><div class="ttdoc">True if this is a licensed copy of the add-in. </div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l01034">ThisAddIn.cs:1034</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_properties_1_1_resources_html_a186368c19174d13c48724c8d5b6cd39b"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_properties_1_1_resources.html#a186368c19174d13c48724c8d5b6cd39b">SuiteCRMAddIn.Properties.Resources.SuiteCRMLogo</a></div><div class="ttdeci">static System.Drawing.Bitmap SuiteCRMLogo</div><div class="ttdoc">Looks up a localized resource of type System.Drawing.Bitmap. </div><div class="ttdef"><b>Definition:</b> <a href="_resources_8_designer_8cs_source.html#l00156">Resources.Designer.cs:156</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_properties_1_1_settings_html_a5b5f32edfea37ca1a3f1d568b3ae52ac"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a5b5f32edfea37ca1a3f1d568b3ae52ac">SuiteCRMAddIn.Properties.Settings.LicenceKey</a></div><div class="ttdeci">string LicenceKey</div><div class="ttdef"><b>Definition:</b> <a href="_suite_c_r_m_add_in_2_properties_2_settings_8_designer_8cs_source.html#l00300">Settings.Designer.cs:300</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_properties_1_1_resources_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_properties_1_1_resources.html">SuiteCRMAddIn.Properties.Resources</a></div><div class="ttdoc">A strongly-typed resource class, for looking up localized strings, etc. </div><div class="ttdef"><b>Definition:</b> <a href="_resources_8_designer_8cs_source.html#l00025">Resources.Designer.cs:25</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_ribbon_image_helper_html_ab6c37f7066ccafd90143fe3803cb3c8b"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_ribbon_image_helper.html#ab6c37f7066ccafd90143fe3803cb3c8b">SuiteCRMAddIn.RibbonImageHelper.Convert</a></div><div class="ttdeci">static IPictureDisp Convert(Image image)</div><div class="ttdef"><b>Definition:</b> <a href="_ribbon_image_helper_8cs_source.html#l00036">RibbonImageHelper.cs:36</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_aa46936bb917201fce8670a4de7f50649"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aa46936bb917201fce8670a4de7f50649">SuiteCRMAddIn.ThisAddIn.OutlookVersion</a></div><div class="ttdeci">OutlookMajorVersion OutlookVersion</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00060">ThisAddIn.cs:60</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_properties_1_1_resources_html_a0b08bb92aff67652dcb680702f91e139"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_properties_1_1_resources.html#a0b08bb92aff67652dcb680702f91e139">SuiteCRMAddIn.Properties.Resources.Settings</a></div><div class="ttdeci">static System.Drawing.Bitmap Settings</div><div class="ttdoc">Looks up a localized resource of type System.Drawing.Bitmap. </div><div class="ttdef"><b>Definition:</b> <a href="_resources_8_designer_8cs_source.html#l00136">Resources.Designer.cs:136</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_properties_1_1_settings_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html">SuiteCRMAddIn.Properties.Settings</a></div><div class="ttdef"><b>Definition:</b> <a href="_suite_c_r_m_add_in_2_properties_2_settings_8_designer_8cs_source.html#l00016">Settings.Designer.cs:16</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a5f4393ccf24f13b7921748075c8260ca"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a5f4393ccf24f13b7921748075c8260ca">SuiteCRMAddIn.ThisAddIn.ShowAddressBook</a></div><div class="ttdeci">void ShowAddressBook()</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00551">ThisAddIn.cs:551</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_daemon_1_1_daemon_worker_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_daemon_1_1_daemon_worker.html">SuiteCRMAddIn.Daemon.DaemonWorker</a></div><div class="ttdoc">A thing which maintains a queue of tasks (instances of DaemonAction) and executes them in turn...</div><div class="ttdef"><b>Definition:</b> <a href="_daemon_worker_8cs_source.html#l00037">DaemonWorker.cs:37</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_daemon_1_1_daemon_worker_html_a759291681be3f2fd27ee7e82f0547fb6"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_daemon_1_1_daemon_worker.html#a759291681be3f2fd27ee7e82f0547fb6">SuiteCRMAddIn.Daemon.DaemonWorker.AddTask</a></div><div class="ttdeci">void AddTask(DaemonAction task)</div><div class="ttdoc">Add a task to my queue. </div><div class="ttdef"><b>Definition:</b> <a href="_daemon_worker_8cs_source.html#l00078">DaemonWorker.cs:78</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_crm_id_html_ae8a022a1d7034b495864a55ede1e0e72"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_crm_id.html#ae8a022a1d7034b495864a55ede1e0e72">SuiteCRMAddIn.BusinessLogic.CrmId.IsValid</a></div><div class="ttdeci">static bool IsValid(string id)</div><div class="ttdoc">Validates a CRM id. </div><div class="ttdef"><b>Definition:</b> <a href="_crm_id_8cs_source.html#l00097">CrmId.cs:97</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_robustness_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_robustness.html">SuiteCRMAddIn.Robustness</a></div><div class="ttdoc">Utility class. All event-handlers (in fact: all top-level entry-points) should have error handling ro...</div><div class="ttdef"><b>Definition:</b> <a href="_robustness_8cs_source.html#l00010">Robustness.cs:10</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process_html_a1807d77e723339e933844895c68b3b4f"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process.html#a1807d77e723339e933844895c68b3b4f">SuiteCRMAddIn.BusinessLogic.RepeatingProcess.Start</a></div><div class="ttdeci">void Start()</div><div class="ttdoc">If I am not currently running, set me running. </div><div class="ttdef"><b>Definition:</b> <a href="_repeating_process_8cs_source.html#l00302">RepeatingProcess.cs:302</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a01bdbe5957bd96dfaf5845461aff26e8"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a01bdbe5957bd96dfaf5845461aff26e8">SuiteCRMAddIn.ThisAddIn.Application</a></div><div class="ttdeci">Microsoft.Office.Interop.Outlook.Application Application</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8_designer_8cs_source.html#l00026">ThisAddIn.Designer.cs:26</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a4b3b3ac7e3fcfa7ec447a4729be4ee4f"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a4b3b3ac7e3fcfa7ec447a4729be4ee4f">SuiteCRMAddIn.ThisAddIn.btnArchive</a></div><div class="ttdeci">Office.CommandBarButton btnArchive</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00058">ThisAddIn.cs:58</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_properties_1_1_settings_html_a025428c4ea0b085cea9b45602e6d7ee5"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a025428c4ea0b085cea9b45602e6d7ee5">SuiteCRMAddIn.Properties.Settings.AutoArchive</a></div><div class="ttdeci">bool AutoArchive</div><div class="ttdef"><b>Definition:</b> <a href="_suite_c_r_m_add_in_2_properties_2_settings_8_designer_8cs_source.html#l00216">Settings.Designer.cs:216</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_dialogs_1_1_shutting_down_dialog_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_dialogs_1_1_shutting_down_dialog.html">SuiteCRMAddIn.Dialogs.ShuttingDownDialog</a></div><div class="ttdef"><b>Definition:</b> <a href="_shutting_down_dialog_8cs_source.html#l00031">ShuttingDownDialog.cs:31</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_client_1_1_email_html"><div class="ttname"><a href="namespace_suite_c_r_m_client_1_1_email.html">SuiteCRMClient.Email</a></div><div class="ttdoc">Email JSON interface; much of this is pretty ugly and still needs rework. </div><div class="ttdef"><b>Definition:</b> <a href="_archiveable_attachment_8cs_source.html#l00024">ArchiveableAttachment.cs:24</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_dialogs_1_1_settings_dialog_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_dialogs_1_1_settings_dialog.html">SuiteCRMAddIn.Dialogs.SettingsDialog</a></div><div class="ttdef"><b>Definition:</b> <a href="_settings_dialog_8cs_source.html#l00037">SettingsDialog.cs:37</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_properties_1_1_settings_html_a50d10ee7eabe83fb782982a158734170"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#a50d10ee7eabe83fb782982a158734170">SuiteCRMAddIn.Properties.Settings.ExcludedEmails</a></div><div class="ttdeci">string ExcludedEmails</div><div class="ttdef"><b>Definition:</b> <a href="_suite_c_r_m_add_in_2_properties_2_settings_8_designer_8cs_source.html#l00073">Settings.Designer.cs:73</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_manager_html_aca32dffb3e78093659e983544c33290f"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_manager.html#aca32dffb3e78093659e983544c33290f">SuiteCRMAddIn.BusinessLogic.SyncStateManager.CountItems</a></div><div class="ttdeci">int CountItems()</div><div class="ttdoc">Count the number of items I monitor. </div><div class="ttdef"><b>Definition:</b> <a href="_sync_state_manager_8cs_source.html#l00216">SyncStateManager.cs:216</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_aa11073e39b068391a2bb352942bd7cc9"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aa11073e39b068391a2bb352942bd7cc9">SuiteCRMAddIn.ThisAddIn.StopUnconfiguredSynchronisationProcesses</a></div><div class="ttdeci">void StopUnconfiguredSynchronisationProcesses()</div><div class="ttdoc">Start all synchronisation processes that are not configured to run, if they are already running...</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00462">ThisAddIn.cs:462</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_crm_id_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_crm_id.html">SuiteCRMAddIn.BusinessLogic.CrmId</a></div><div class="ttdoc">A validated CRM id. </div><div class="ttdef"><b>Definition:</b> <a href="_crm_id_8cs_source.html#l00035">CrmId.cs:35</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context_html_ac800c823d97baf0a18035333cb1fbe2d"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context.html#ac800c823d97baf0a18035333cb1fbe2d">SuiteCRMAddIn.BusinessLogic.SyncContext.Log</a></div><div class="ttdeci">ILogger Log</div><div class="ttdef"><b>Definition:</b> <a href="_sync_context_8cs_source.html#l00044">SyncContext.cs:44</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process_html_adb3223c50e803350f04dfaf1766641a4"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process.html#adb3223c50e803350f04dfaf1766641a4">SuiteCRMAddIn.BusinessLogic.RepeatingProcess.Name</a></div><div class="ttdeci">readonly string Name</div><div class="ttdoc">The name by which I am known. </div><div class="ttdef"><b>Definition:</b> <a href="_repeating_process_8cs_source.html#l00077">RepeatingProcess.cs:77</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_log4_net_logger_html_a55cc627fa46c34ecc33662ff09c977c8"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_log4_net_logger.html#a55cc627fa46c34ecc33662ff09c977c8">SuiteCRMAddIn.Log4NetLogger.FromFilePath</a></div><div class="ttdeci">static Log4NetLogger FromFilePath(string area, string filePath, Func&lt; IEnumerable&lt; string &gt;&gt; headerFunction, LogEntryType entryType)</div><div class="ttdef"><b>Definition:</b> <a href="_log4_net_logger_8cs_source.html#l00119">Log4NetLogger.cs:119</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_synchroniser_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_synchroniser.html">SuiteCRMAddIn.BusinessLogic.TaskSynchroniser</a></div><div class="ttdoc">An agent which synchronises Outlook Task items with CRM. </div><div class="ttdef"><b>Definition:</b> <a href="_task_synchroniser_8cs_source.html#l00039">TaskSynchroniser.cs:39</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a70b83a2731db0d1f8c1958c27240fc82"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a70b83a2731db0d1f8c1958c27240fc82">SuiteCRMAddIn.ThisAddIn.CallsSynchroniser</a></div><div class="ttdeci">CallsSynchroniser CallsSynchroniser</div><div class="ttdoc">#2246: Discriminate between calls and meetings when adding and updating. </div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00071">ThisAddIn.cs:71</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a667c806625d781a8d528bae58347c113"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a667c806625d781a8d528bae58347c113">SuiteCRMAddIn.ThisAddIn.CountItems</a></div><div class="ttdeci">int CountItems()</div><div class="ttdoc">Count how many items there are whose state I am monitoring. </div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l01075">ThisAddIn.cs:1075</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a096883436afdc359db036a8bdec9c9aa"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a096883436afdc359db036a8bdec9c9aa">SuiteCRMAddIn.ThisAddIn.GetSynchronisableItems</a></div><div class="ttdeci">IEnumerable&lt; WithRemovableSynchronisationProperties &gt; GetSynchronisableItems()</div><div class="ttdoc">Get all the synchronisable items I&amp;#39;m tracking - at present, only as WithRemovableSynchronisationPrope...</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l01085">ThisAddIn.cs:1085</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a9d0e15278e7570ae6acc60ed081d7bdb"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a9d0e15278e7570ae6acc60ed081d7bdb">SuiteCRMAddIn.ThisAddIn.Authenticate</a></div><div class="ttdeci">bool Authenticate(string host, string username, string password, string ldapKey)</div><div class="ttdoc">Authenticate against CRM using these parameters. </div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00925">ThisAddIn.cs:925</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_manager_html_a449408102ad970c15d3df7641fafcab2"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_manager.html#a449408102ad970c15d3df7641fafcab2">SuiteCRMAddIn.BusinessLogic.SyncStateManager.Instance</a></div><div class="ttdeci">static SyncStateManager Instance</div><div class="ttdoc">A public accessor for my instance. </div><div class="ttdef"><b>Definition:</b> <a href="_sync_state_manager_8cs_source.html#l00124">SyncStateManager.cs:124</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1_server_info_html_a9d7cbb93541e6ed072d1ed61a8049fff"><div class="ttname"><a href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1_server_info.html#a9d7cbb93541e6ed072d1ed61a8049fff">SuiteCRMClient.RESTObjects.ServerInfo.SuiteCRMVersion</a></div><div class="ttdeci">string SuiteCRMVersion</div><div class="ttdoc">Version of SuiteCRM. Note: this field is not present before SuiteCRM version 7.8.5. </div><div class="ttdef"><b>Definition:</b> <a href="_server_info_8cs_source.html#l00048">ServerInfo.cs:48</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html">SuiteCRMAddIn.BusinessLogic.SyncDirection</a></div><div class="ttdoc">A direction in which things may be synchronised. Directions are named with respect to CRM...</div><div class="ttdef"><b>Definition:</b> <a href="_sync_direction_8cs_source.html#l00029">SyncDirection.cs:29</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html">SuiteCRMAddIn.ThisAddIn</a></div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00050">ThisAddIn.cs:50</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_aee77aec45c87898261c4ca5f91ae2476"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#aee77aec45c87898261c4ca5f91ae2476">SuiteCRMAddIn.ThisAddIn.Authenticate</a></div><div class="ttdeci">bool Authenticate()</div><div class="ttdoc">Authenticate against CRM using parameters taken from default settings. </div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00910">ThisAddIn.cs:910</a></div></div>
<div class="ttc" id="namespace_n_gettext_html"><div class="ttname"><a href="namespace_n_gettext.html">NGettext</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a912a8f4c13342a9f8673693b8424f90c"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a912a8f4c13342a9f8673693b8424f90c">SuiteCRMAddIn.ThisAddIn.ManualSyncContact</a></div><div class="ttdeci">void ManualSyncContact()</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00206">ThisAddIn.cs:206</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a059ba6330fe696daba3c216994fd5fc7"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a059ba6330fe696daba3c216994fd5fc7">SuiteCRMAddIn.ThisAddIn.EmailArchiver</a></div><div class="ttdeci">EmailArchiving EmailArchiver</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00086">ThisAddIn.cs:86</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a8425742ee8ea655955254316a4a7a60e"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8425742ee8ea655955254316a4a7a60e">SuiteCRMAddIn.ThisAddIn.ContactsSynchroniser</a></div><div class="ttdeci">ContactSynchroniser ContactsSynchroniser</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00077">ThisAddIn.cs:77</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a89f35eb63bc93448017eeda72408096e"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a89f35eb63bc93448017eeda72408096e">SuiteCRMAddIn.ThisAddIn.objSuiteCRMMenuBar2007</a></div><div class="ttdeci">Office.CommandBarPopup objSuiteCRMMenuBar2007</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00057">ThisAddIn.cs:57</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_email_archiving_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_email_archiving.html">SuiteCRMAddIn.BusinessLogic.EmailArchiving</a></div><div class="ttdoc">The agent which handles the automatic and manual archiving of emails. </div><div class="ttdef"><b>Definition:</b> <a href="_email_archiving_8cs_source.html#l00045">EmailArchiving.cs:45</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a91947c0f74700ebb78a18258279fe8a4"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a91947c0f74700ebb78a18258279fe8a4">SuiteCRMAddIn.ThisAddIn.SuiteCRMUserSession</a></div><div class="ttdeci">SuiteCRMClient.UserSession SuiteCRMUserSession</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00055">ThisAddIn.cs:55</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_meetings_synchroniser_html_a3feecd7b6d39a556a71f9fe7a3ea93c7"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_meetings_synchroniser.html#a3feecd7b6d39a556a71f9fe7a3ea93c7">SuiteCRMAddIn.BusinessLogic.MeetingsSynchroniser.DefaultCrmModule</a></div><div class="ttdeci">override string DefaultCrmModule</div><div class="ttdef"><b>Definition:</b> <a href="_meetings_synchroniser_8cs_source.html#l00045">MeetingsSynchroniser.cs:45</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_properties_1_1_settings_html_af9da6ec23fc6dc475185f3016344cf81"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_properties_1_1_settings.html#af9da6ec23fc6dc475185f3016344cf81">SuiteCRMAddIn.Properties.Settings.LogLevel</a></div><div class="ttdeci">global::SuiteCRMClient.Logging.LogEntryType LogLevel</div><div class="ttdef"><b>Definition:</b> <a href="_suite_c_r_m_add_in_2_properties_2_settings_8_designer_8cs_source.html#l00276">Settings.Designer.cs:276</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process_html_a708c4cbb44af74854ce2f236e78f2f9e"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process.html#a708c4cbb44af74854ce2f236e78f2f9e">SuiteCRMAddIn.BusinessLogic.RepeatingProcess.IsActive</a></div><div class="ttdeci">Boolean IsActive</div><div class="ttdoc">True if I should be active, else false. </div><div class="ttdef"><b>Definition:</b> <a href="_repeating_process_8cs_source.html#l00124">RepeatingProcess.cs:124</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a0cb1559d67fa90a6f9a7e423e9e6d0fd"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a0cb1559d67fa90a6f9a7e423e9e6d0fd">SuiteCRMAddIn.ThisAddIn.SelectedContacts</a></div><div class="ttdeci">IEnumerable&lt; Outlook.ContactItem &gt; SelectedContacts</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l01016">ThisAddIn.cs:1016</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1_user_session_html_a61cf62b4a67202acf08a834cbe44c5ab"><div class="ttname"><a href="class_suite_c_r_m_client_1_1_user_session.html#a61cf62b4a67202acf08a834cbe44c5ab">SuiteCRMClient.UserSession.LogOut</a></div><div class="ttdeci">void LogOut()</div><div class="ttdoc">The documentation at http://support.sugarcrm.com/Documentation/Sugar_Developer/Sugar_Developer_Guide_...</div><div class="ttdef"><b>Definition:</b> <a href="_user_session_8cs_source.html#l00240">UserSession.cs:240</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1_rest_a_p_i_wrapper_html_ad67beabea121917433d6439617a7ef32"><div class="ttname"><a href="class_suite_c_r_m_client_1_1_rest_a_p_i_wrapper.html#ad67beabea121917433d6439617a7ef32">SuiteCRMClient.RestAPIWrapper.GetEntry</a></div><div class="ttdeci">static Entry GetEntry(string module, string id, string[] fields, object linkNamesToFieldsArray=null)</div><div class="ttdoc">Get the specified entry from the specified module. </div><div class="ttdef"><b>Definition:</b> <a href="_rest_a_p_i_wrapper_8cs_source.html#l00526">RestAPIWrapper.cs:526</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_dialogs_1_1_archive_dialog_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_dialogs_1_1_archive_dialog.html">SuiteCRMAddIn.Dialogs.ArchiveDialog</a></div><div class="ttdef"><b>Definition:</b> <a href="_archive_dialog_8cs_source.html#l00045">ArchiveDialog.cs:45</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_daemon_1_1_deferred_startup_action_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_daemon_1_1_deferred_startup_action.html">SuiteCRMAddIn.Daemon.DeferredStartupAction</a></div><div class="ttdef"><b>Definition:</b> <a href="_deferred_startup_action_8cs_source.html#l00030">DeferredStartupAction.cs:30</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction_html_ad456cb19bab5eb78bc35f7b305274d01"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html#ad456cb19bab5eb78bc35f7b305274d01">SuiteCRMAddIn.BusinessLogic.SyncDirection.AllowOutbound</a></div><div class="ttdeci">static bool AllowOutbound(Direction direction)</div><div class="ttdoc">Does this direction allow outbound transfers from Outlook? </div><div class="ttdef"><b>Definition:</b> <a href="_sync_direction_8cs_source.html#l00088">SyncDirection.cs:88</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a86ebbad56f266bb74375ebcc414f2347"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a86ebbad56f266bb74375ebcc414f2347">SuiteCRMAddIn.ThisAddIn.MeetingsSynchroniser</a></div><div class="ttdeci">MeetingsSynchroniser MeetingsSynchroniser</div><div class="ttdoc">#2246: Discriminate between calls and meetings when adding and updating. </div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00075">ThisAddIn.cs:75</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_afec23a14c60746240b13e5ddefccf4ae"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#afec23a14c60746240b13e5ddefccf4ae">SuiteCRMAddIn.ThisAddIn.LogDirPath</a></div><div class="ttdeci">static string LogDirPath</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00391">ThisAddIn.cs:391</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a8e4511bd9e35cdd0b86024d96341990b"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8e4511bd9e35cdd0b86024d96341990b">SuiteCRMAddIn.ThisAddIn.ShowSettingsForm</a></div><div class="ttdeci">DialogResult ShowSettingsForm()</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00544">ThisAddIn.cs:544</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a64093b46d58d23f3bb0e866e299745ba"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a64093b46d58d23f3bb0e866e299745ba">SuiteCRMAddIn.ThisAddIn.StartConfiguredSynchronisationProcesses</a></div><div class="ttdeci">void StartConfiguredSynchronisationProcesses()</div><div class="ttdoc">Start all synchronisation processes that are configured, if they are not already running. </div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00449">ThisAddIn.cs:449</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_calls_synchroniser_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_calls_synchroniser.html">SuiteCRMAddIn.BusinessLogic.CallsSynchroniser</a></div><div class="ttdef"><b>Definition:</b> <a href="_calls_synchroniser_8cs_source.html#l00029">CallsSynchroniser.cs:29</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a98cbecd9f92c5928ca248bc4b40b6b62"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a98cbecd9f92c5928ca248bc4b40b6b62">SuiteCRMAddIn.ThisAddIn.Disable</a></div><div class="ttdeci">void Disable()</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00335">ThisAddIn.cs:335</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context.html">SuiteCRMAddIn.BusinessLogic.SyncContext</a></div><div class="ttdoc">A bundle of handles onto all the things which are needed to allow synchronisation to take place...</div><div class="ttdef"><b>Definition:</b> <a href="_sync_context_8cs_source.html#l00031">SyncContext.cs:31</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a5a59515dac58ee4eb1169adf2f3d597b"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a5a59515dac58ee4eb1169adf2f3d597b">SuiteCRMAddIn.ThisAddIn.ShowReconfigureOrDisable</a></div><div class="ttdeci">DialogResult ShowReconfigureOrDisable(string summary, bool allowRetry=false)</div><div class="ttdoc">Show the reconfigure or disable dialogue with this summary of the problem. </div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00363">ThisAddIn.cs:363</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a9081d833c94c4f85712c247d34dae5aa"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a9081d833c94c4f85712c247d34dae5aa">SuiteCRMAddIn.ThisAddIn.SelectedEmailCount</a></div><div class="ttdeci">int SelectedEmailCount</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00998">ThisAddIn.cs:998</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_add_in_html_a0299c983ae44fbfee337a7d4312b04af"><div class="ttname"><a href="namespace_suite_c_r_m_add_in.html#a0299c983ae44fbfee337a7d4312b04af">SuiteCRMAddIn.OutlookMajorVersion</a></div><div class="ttdeci">OutlookMajorVersion</div><div class="ttdef"><b>Definition:</b> <a href="_outlook_major_version_8cs_source.html#l00003">OutlookMajorVersion.cs:3</a></div></div>
<div class="ttc" id="namespace_office_html"><div class="ttname"><a href="namespace_office.html">Office</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_client_html"><div class="ttname"><a href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a></div><div class="ttdoc">SuiteCRMClient is a client library for the SuiteCRM JSON API. </div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a29a3f70d27e47811fe557d2d8a2cad8a"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a29a3f70d27e47811fe557d2d8a2cad8a">SuiteCRMAddIn.ThisAddIn.ReinitialiseSession</a></div><div class="ttdeci">void ReinitialiseSession(string host, string username, string password, string ldapKey)</div><div class="ttdoc">Replace the existing user session, if any, with a new one using these parameters. ...</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00973">ThisAddIn.cs:973</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a3d3136423943e3e4f71d3ea2b1062147"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a3d3136423943e3e4f71d3ea2b1062147">SuiteCRMAddIn.ThisAddIn.ManualArchive</a></div><div class="ttdeci">void ManualArchive()</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00584">ThisAddIn.cs:584</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a59e3329b343e57d18faafdc4a0c4ee03"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a59e3329b343e57d18faafdc4a0c4ee03">SuiteCRMAddIn.ThisAddIn.ProgId</a></div><div class="ttdeci">const string ProgId</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l00052">ThisAddIn.cs:52</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_daemon_1_1_daemon_worker_html_a7cd50a597c99ce8c1167eee208224e37"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_daemon_1_1_daemon_worker.html#a7cd50a597c99ce8c1167eee208224e37">SuiteCRMAddIn.Daemon.DaemonWorker.Instance</a></div><div class="ttdeci">static DaemonWorker Instance</div><div class="ttdoc">A public accessor for my instance. </div><div class="ttdef"><b>Definition:</b> <a href="_daemon_worker_8cs_source.html#l00053">DaemonWorker.cs:53</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html">SuiteCRMAddIn.BusinessLogic.Synchroniser</a></div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00045">Synchroniser.cs:45</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_add_in_html"><div class="ttname"><a href="namespace_suite_c_r_m_add_in.html">SuiteCRMAddIn</a></div></div>
<div class="ttc" id="interface_suite_c_r_m_client_1_1_logging_1_1_i_logger_html"><div class="ttname"><a href="interface_suite_c_r_m_client_1_1_logging_1_1_i_logger.html">SuiteCRMClient.Logging.ILogger</a></div><div class="ttdoc">Interface implemented by all logging classes </div><div class="ttdef"><b>Definition:</b> <a href="_i_logger_8cs_source.html#l00009">ILogger.cs:9</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_error_handler_html_aa5ac5699b0099c7a812a895751df5e07"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_error_handler.html#aa5ac5699b0099c7a812a895751df5e07">SuiteCRMAddIn.BusinessLogic.ErrorHandler.Handle</a></div><div class="ttdeci">static void Handle(Exception error)</div><div class="ttdef"><b>Definition:</b> <a href="_error_handler_8cs_source.html#l00040">ErrorHandler.cs:40</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_this_add_in_html_a8f019e8cd74b651865a318ef26ceb30f"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_this_add_in.html#a8f019e8cd74b651865a318ef26ceb30f">SuiteCRMAddIn.ThisAddIn.ShowAndLogError</a></div><div class="ttdeci">void ShowAndLogError(Exception error, string message, string summary)</div><div class="ttdef"><b>Definition:</b> <a href="_this_add_in_8cs_source.html#l01061">ThisAddIn.cs:1061</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_error_handler_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_error_handler.html">SuiteCRMAddIn.BusinessLogic.ErrorHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="_error_handler_8cs_source.html#l00037">ErrorHandler.cs:37</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process_html_a1484b532908abdfad6640cc758cd2f37"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_repeating_process.html#a1484b532908abdfad6640cc758cd2f37">SuiteCRMAddIn.BusinessLogic.RepeatingProcess.Stop</a></div><div class="ttdeci">bool Stop()</div><div class="ttdoc">Stop me at the end of my current iteration; does not force an immediate stop unless no work is curren...</div><div class="ttdef"><b>Definition:</b> <a href="_repeating_process_8cs_source.html#l00283">RepeatingProcess.cs:283</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_dialogs_1_1frm_address_book_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_dialogs_1_1frm_address_book.html">SuiteCRMAddIn.Dialogs.frmAddressBook</a></div><div class="ttdef"><b>Definition:</b> <a href="_address_book_8cs_source.html#l00033">AddressBook.cs:33</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_3341eda471cc1faa5052bfebf1426198.html">SuiteCRMAddIn</a></li><li class="navelem"><a class="el" href="_this_add_in_8cs.html">ThisAddIn.cs</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
