<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>SuiteCRM Outlook Add-in: SuiteCRMAddIn/BusinessLogic/ContactSyncing.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="CompanyLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SuiteCRM Outlook Add-in
   &#160;<span id="projectnumber">3.0.4.0</span>
   </div>
   <div id="projectbrief">An outlook add-in which allows synchronisation with SuiteCRM</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_contact_syncing_8cs_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ContactSyncing.cs</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_contact_syncing_8cs.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_suite_c_r_m_add_in.html">SuiteCRMAddIn</a>.BusinessLogic</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keyword">using</span> ProtoItems;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a>.<a class="code" href="namespace_suite_c_r_m_client_1_1_logging.html">Logging</a>;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a>.<a class="code" href="namespace_suite_c_r_m_client_1_1_r_e_s_t_objects.html">RESTObjects</a>;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Collections.Generic;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Linq;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Runtime.InteropServices;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Windows.Forms;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_outlook.html">Outlook</a> = Microsoft.Office.Interop.Outlook;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html">   39</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html">ContactSyncing</a>: <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html">Synchroniser</a>&lt;Outlook.ContactItem&gt;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    {</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#abaac66bc3f0333f29f3950607f751462">   44</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#abaac66bc3f0333f29f3950607f751462">CrmModule</a> = <span class="stringliteral">&quot;Contacts&quot;</span>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a89a4299b5dac6324d218467202dfe30e">   46</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a89a4299b5dac6324d218467202dfe30e">ContactSyncing</a>(<span class="keywordtype">string</span> name, <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context.html">SyncContext</a> context)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            : base(name, context)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#acc0767f43a7c30dea23d8c6023edd2ab">fetchQueryPrefix</a> = <span class="stringliteral">&quot;contacts.assigned_user_id = &#39;{0}&#39;&quot;</span>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a603e067624ee2112311c34b85625279f">   52</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">override</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html">SyncDirection</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html#aee195368e938ed8e05fa3ec669838c06">Direction</a> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a603e067624ee2112311c34b85625279f">Direction</a> =&gt; Properties.Settings.Default.SyncContacts;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">object</span> txLock = <span class="keyword">new</span> object();</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">object</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#aa13c973be68574d93d46bb35fd634e5f">TransmissionLock</a></div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#aa13c973be68574d93d46bb35fd634e5f">   63</a></span>&#160;        {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keyword">get</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                <span class="keywordflow">return</span> txLock;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keyword">public</span> <span class="keyword">override</span> <span class="keywordtype">string</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a6cd13ab6212d4c852e838fd50e7751b6">DefaultCrmModule</a></div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a6cd13ab6212d4c852e838fd50e7751b6">   71</a></span>&#160;        {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keyword">get</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html">ContactSyncing</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#abaac66bc3f0333f29f3950607f751462">CrmModule</a>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            }</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#ae0c207e0086d51d9c11ff9baca2d8fba">   78</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#ae0c207e0086d51d9c11ff9baca2d8fba">SaveItem</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem olItem)</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        {</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            olItem.Save();</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#afff6b1974cece09abe1eaae8417e33a8">   88</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#afff6b1974cece09abe1eaae8417e33a8">SyncFolder</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.MAPIFolder folder, <span class="keywordtype">string</span> crmModule)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            Log.Info($<span class="stringliteral">&quot;ContactSyncing.SyncFolder: &#39;{folder}&#39;&quot;</span>);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                <span class="keywordflow">if</span> (this.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a8612fe5996262db88cad121c4580ba7c">permissionsCache</a>.HasExportAccess())</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                    var untouched = <span class="keyword">new</span> HashSet&lt;<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState</a>&lt;<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem&gt;&gt;(<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a0ea303cb4210eb22c79d6f8f0d859a39">ItemsSyncState</a>);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#acc7036a95cd34952cf01c774b1fcefc2">MergeRecordsFromCrm</a>(folder, crmModule, untouched);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                    <span class="keywordflow">try</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                    {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                        var syncableButNotOnCrm = untouched.Where(s =&gt; s.ShouldSyncWithCrm);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                        <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a483e9fe3f7b8356dd85b53d7d4014f50">ResolveUnmatchedItems</a>(syncableButNotOnCrm);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                    }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                    <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                    {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                        Log.Error(<span class="stringliteral">&quot;ContactSyncing.SyncContacts&quot;</span>, ex);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                    }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                    Log.Warn(<span class="stringliteral">&quot;ContactSyncing.SyncContacts: CRM server denied access to export Contacts&quot;</span>);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                }</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                Log.Error(<span class="stringliteral">&quot;ContactSyncing.SyncContacts&quot;</span>, ex);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="comment">// TODO: this is horrible and should be reworked.</span></div><div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a8a0d14bba071fb1083d9be9b497de642">  121</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState</a>&lt;<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem&gt; <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a8a0d14bba071fb1083d9be9b497de642">AddOrUpdateItemFromCrmToOutlook</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.MAPIFolder folder, <span class="keywordtype">string</span> crmType, <a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html">eEntryValue</a> crmItem)</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState</a>&lt;<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem&gt; result = null;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            String <span class="keywordtype">id</span> = crmItem.GetValueAsString(<span class="stringliteral">&quot;id&quot;</span>);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState</a>&lt;<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem&gt; syncStateForItem = <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a22031f77a31ab4d27818815ebc85786d">GetExistingSyncState</a>(crmItem);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keywordflow">if</span> (ShouldSyncContact(crmItem))</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                Log.Info(</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    <span class="keywordtype">string</span>.Format(</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                        <span class="stringliteral">&quot;ContactSyncing.UpdateFromCrm, entry id is &#39;{0}&#39;, sync_contact is true, syncing&quot;</span>,</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                        <span class="keywordtype">id</span>));</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                <span class="keywordflow">if</span> (syncStateForItem == null)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                    <span class="comment">/* check for howlaround */</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                    var matches = this.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a9e06c6056beacdb87f5d807f4739b9ba">FindMatches</a>(crmItem);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                    <span class="keywordflow">if</span> (matches.Count == 0)</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                    {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                        <span class="comment">/* didn&#39;t find it, so add it to Outlook */</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                        result = AddNewItemFromCrmToOutlook(folder, crmItem);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                    }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                        this.Log.Warn($<span class="stringliteral">&quot;Howlaround detected? Contact &#39;{crmItem.GetValueAsString(&quot;</span>name<span class="stringliteral">&quot;)}&#39; offered with id {crmItem.GetValueAsString(&quot;</span><span class="keywordtype">id</span><span class="stringliteral">&quot;)}, expected {matches[0].CrmEntryId}, {matches.Count} duplicates&quot;</span>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                    }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                    result = UpdateExistingOutlookItemFromCrm(crmItem, syncStateForItem);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (syncStateForItem != null &amp;&amp;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                syncStateForItem.OutlookItem != null)</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <span class="comment">/* The date_modified value in CRM does not get updated when the sync_contact value</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">                 * is changed. But seeing this value can only be updated at the CRM side, if it</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">                 * has changed the change must have been at the CRM side. It doesn&#39;t change to false,</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">                 * it simply ceases to be sent. Set the item to Private in Outlook. */</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                <span class="keywordflow">if</span> (syncStateForItem.OutlookItem.Sensitivity != <a class="code" href="namespace_outlook.html">Outlook</a>.OlSensitivity.olPrivate)</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                    Log.Info($<span class="stringliteral">&quot;ContactSyncing.UpdateFromCrm: setting sensitivity of contact {crmItem.GetValueAsString(&quot;</span>first_name<span class="stringliteral">&quot;)} {crmItem.GetValueAsString(&quot;</span>last_name<span class="stringliteral">&quot;)} ({crmItem.GetValueAsString(&quot;</span>email1<span class="stringliteral">&quot;)}) to private&quot;</span>);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                    syncStateForItem.OutlookItem.Sensitivity = <a class="code" href="namespace_outlook.html">Outlook</a>.OlSensitivity.olPrivate;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                result = syncStateForItem;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                Log.Info(</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    <span class="keywordtype">string</span>.Format(</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                        <span class="stringliteral">&quot;ContactSyncing.UpdateFromCrm, entry id is &#39;{0}&#39;, sync_contact is false, not syncing&quot;</span>,</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                        <span class="keywordtype">id</span>));</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                result = syncStateForItem;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> ShouldSyncFlagChanged(<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem olItem, <a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html">eEntryValue</a> crmItem)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <a class="code" href="namespace_outlook.html">Outlook</a>.UserProperty shouldSyncProp = olItem.UserProperties[<span class="stringliteral">&quot;SShouldSync&quot;</span>];</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keywordflow">if</span> (shouldSyncProp != null)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <span class="keywordtype">string</span> crmShouldSync = ShouldSyncContact(crmItem).ToString().ToLower();</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <span class="keywordtype">string</span> olShouldSync = shouldSyncProp.Value.ToLower();</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                result = crmShouldSync != olShouldSync;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keyword">private</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState</a>&lt;<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem&gt; AddNewItemFromCrmToOutlook(<a class="code" href="namespace_outlook.html">Outlook</a>.MAPIFolder contactFolder, <a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html">eEntryValue</a> crmItem)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            Log.Info(</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                (<span class="keywordtype">string</span>)<span class="keywordtype">string</span>.Format(</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                    <span class="stringliteral">&quot;ContactSyncing.AddNewItemFromCrmToOutlook, entry id is &#39;{0}&#39;, creating in Outlook.&quot;</span>,</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                    crmItem.GetValueAsString(<span class="stringliteral">&quot;id&quot;</span>)));</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem olItem = contactFolder.Items.Add(<a class="code" href="namespace_outlook.html">Outlook</a>.OlItemType.olContactItem);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            this.SetOutlookItemPropertiesFromCrmItem(crmItem, olItem);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            var newState = <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_sync_state.html">ContactSyncState</a></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                OutlookItem = olItem,</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                OModifiedDate = DateTime.ParseExact(crmItem.GetValueAsString(<span class="stringliteral">&quot;date_modified&quot;</span>), <span class="stringliteral">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>, null),</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                CrmEntryId = crmItem.GetValueAsString(<span class="stringliteral">&quot;id&quot;</span>),</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            };</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a0ea303cb4210eb22c79d6f8f0d859a39">ItemsSyncState</a>.Add(newState);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a9ec0ba9a0d4a426fa90b6856f2c1b0e9">LogItemAction</a>(newState.OutlookItem, <span class="stringliteral">&quot;AppointmentSyncing.AddNewItemFromCrmToOutlook, saved item&quot;</span>);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="keywordflow">return</span> newState;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a9ec0ba9a0d4a426fa90b6856f2c1b0e9">  240</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a9ec0ba9a0d4a426fa90b6856f2c1b0e9">LogItemAction</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem olItem, <span class="keywordtype">string</span> message)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                <a class="code" href="namespace_outlook.html">Outlook</a>.UserProperty olPropertyEntryId = olItem.UserProperties[<span class="stringliteral">&quot;SEntryID&quot;</span>];</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                <span class="keywordtype">string</span> crmId = olPropertyEntryId == null ?</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                    <span class="stringliteral">&quot;[not present]&quot;</span> :</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    olPropertyEntryId.Value;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                Log.Info(</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    String.Format(<span class="stringliteral">&quot;{0}:\n\tOutlook Id  : {1}\n\tCRM Id      : {2}\n\tFull name   : &#39;{3}&#39;\n\tSensitivity : {4}&quot;</span>,</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    message, olItem.EntryID, crmId, olItem.FullName, olItem.Sensitivity));</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="keywordflow">catch</span> (COMException)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="comment">// Ignore: happens if the outlook item is already deleted.</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> ShouldSyncContact(<a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html">eEntryValue</a> crmItem)</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keywordtype">object</span> val = crmItem.GetValue(<span class="stringliteral">&quot;sync_contact&quot;</span>);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="keywordflow">return</span> Boolean.TrueString.ToLower().Equals(val.ToString().ToLower());</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">bool</span> CrmItemChanged(<a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html">eEntryValue</a> crmItem, <a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem olItem)</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <a class="code" href="namespace_outlook.html">Outlook</a>.UserProperty dateModifiedProp = olItem.UserProperties[<span class="stringliteral">&quot;SOModifiedDate&quot;</span>];</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keywordflow">return</span> (dateModifiedProp.Value != crmItem.GetValueAsString(<span class="stringliteral">&quot;date_modified&quot;</span>) ||</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                ShouldSyncFlagChanged(olItem, crmItem));</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keyword">private</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState</a>&lt;<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem&gt; UpdateExistingOutlookItemFromCrm(<a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html">eEntryValue</a> crmItem, <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState&lt;Outlook.ContactItem&gt;</a> itemSyncState)</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keywordflow">if</span> (!itemSyncState.IsDeletedInOutlook)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                <a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem olItem = itemSyncState.OutlookItem;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <a class="code" href="namespace_outlook.html">Outlook</a>.UserProperty dateModifiedProp = olItem.UserProperties[<span class="stringliteral">&quot;SOModifiedDate&quot;</span>];</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <a class="code" href="namespace_outlook.html">Outlook</a>.UserProperty shouldSyncProp = olItem.UserProperties[<span class="stringliteral">&quot;SShouldSync&quot;</span>];</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                this.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a9ec0ba9a0d4a426fa90b6856f2c1b0e9">LogItemAction</a>(olItem, <span class="stringliteral">&quot;ContactSyncing.UpdateExistingOutlookItemFromCrm&quot;</span>);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                <span class="keywordflow">if</span> (CrmItemChanged(crmItem, olItem))</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    DateTime crmDate = DateTime.Parse(crmItem.GetValueAsString(<span class="stringliteral">&quot;date_modified&quot;</span>));</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    DateTime outlookDate = dateModifiedProp == null ? DateTime.MinValue : DateTime.Parse(dateModifiedProp.Value.ToString());</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    <span class="keywordflow">if</span> (crmDate &gt; this.LastRunCompleted &amp;&amp; outlookDate &gt; this.LastRunCompleted)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                    {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                        MessageBox.Show(</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                            $<span class="stringliteral">&quot;Contact {olItem.FirstName} {olItem.LastName} has changed both in Outlook and CRM; please check which is correct&quot;</span>,</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                            <span class="stringliteral">&quot;Update problem&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Warning);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                    }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (crmDate &gt; outlookDate)</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                        this.SetOutlookItemPropertiesFromCrmItem(crmItem, olItem);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                }</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                this.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a9ec0ba9a0d4a426fa90b6856f2c1b0e9">LogItemAction</a>(olItem, <span class="stringliteral">&quot;ContactSyncing.UpdateExistingOutlookItemFromCrm&quot;</span>);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                itemSyncState.OModifiedDate = DateTime.ParseExact(crmItem.GetValueAsString(<span class="stringliteral">&quot;date_modified&quot;</span>), <span class="stringliteral">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>, null);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordflow">return</span> itemSyncState;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> SetOutlookItemPropertiesFromCrmItem(<a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html">eEntryValue</a> crmItem, <a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem olItem)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                olItem.FirstName = crmItem.GetValueAsString(<span class="stringliteral">&quot;first_name&quot;</span>);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                olItem.LastName = crmItem.GetValueAsString(<span class="stringliteral">&quot;last_name&quot;</span>);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                olItem.Email1Address = crmItem.GetValueAsString(<span class="stringliteral">&quot;email1&quot;</span>);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                olItem.BusinessTelephoneNumber = crmItem.GetValueAsString(<span class="stringliteral">&quot;phone_work&quot;</span>);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                olItem.HomeTelephoneNumber = crmItem.GetValueAsString(<span class="stringliteral">&quot;phone_home&quot;</span>);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                olItem.MobileTelephoneNumber = crmItem.GetValueAsString(<span class="stringliteral">&quot;phone_mobile&quot;</span>);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                olItem.JobTitle = crmItem.GetValueAsString(<span class="stringliteral">&quot;title&quot;</span>);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                olItem.Department = crmItem.GetValueAsString(<span class="stringliteral">&quot;department&quot;</span>);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                olItem.BusinessAddressCity = crmItem.GetValueAsString(<span class="stringliteral">&quot;primary_address_city&quot;</span>);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                olItem.BusinessAddressCountry = crmItem.GetValueAsString(<span class="stringliteral">&quot;primary_address_country&quot;</span>);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                olItem.BusinessAddressPostalCode = crmItem.GetValueAsString(<span class="stringliteral">&quot;primary_address_postalcode&quot;</span>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                olItem.BusinessAddressState = crmItem.GetValueAsString(<span class="stringliteral">&quot;primary_address_state&quot;</span>);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                olItem.BusinessAddressStreet = crmItem.GetValueAsString(<span class="stringliteral">&quot;primary_address_street&quot;</span>);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                olItem.Body = crmItem.GetValueAsString(<span class="stringliteral">&quot;description&quot;</span>);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <span class="keywordflow">if</span> (crmItem.GetValue(<span class="stringliteral">&quot;account_name&quot;</span>) != null)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    olItem.Account = crmItem.GetValueAsString(<span class="stringliteral">&quot;account_name&quot;</span>);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                    olItem.CompanyName = crmItem.GetValueAsString(<span class="stringliteral">&quot;account_name&quot;</span>);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                olItem.BusinessFaxNumber = crmItem.GetValueAsString(<span class="stringliteral">&quot;phone_fax&quot;</span>);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                olItem.Title = crmItem.GetValueAsString(<span class="stringliteral">&quot;salutation&quot;</span>);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                <span class="keywordflow">if</span> (olItem.Sensitivity != <a class="code" href="namespace_outlook.html">Outlook</a>.OlSensitivity.olNormal)</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                    Log.Info($<span class="stringliteral">&quot;ContactSyncing.SetOutlookItemPropertiesFromCrmItem: setting sensitivity of contact {crmItem.GetValueAsString(&quot;</span>first_name<span class="stringliteral">&quot;)} {crmItem.GetValueAsString(&quot;</span>last_name<span class="stringliteral">&quot;)} ({crmItem.GetValueAsString(&quot;</span>email1<span class="stringliteral">&quot;)}) to normal&quot;</span>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                    olItem.Sensitivity = <a class="code" href="namespace_outlook.html">Outlook</a>.OlSensitivity.olNormal;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a8c1e906f4a8c369c69e5cdbb73c1cfb2">EnsureSynchronisationPropertiesForOutlookItem</a>(</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                    olItem,</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                    crmItem.GetValueAsString(<span class="stringliteral">&quot;date_modified&quot;</span>),</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                    crmItem.GetValueAsString(<span class="stringliteral">&quot;sync_contact&quot;</span>),</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    crmItem.GetValueAsString(<span class="stringliteral">&quot;id&quot;</span>));</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <span class="keywordflow">finally</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            {</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                olItem.Save();</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a28c8d1b0f9b3e13511bac132221b6c2c">  387</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a28c8d1b0f9b3e13511bac132221b6c2c">EnsureSynchronisationPropertyForOutlookItem</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem olItem, <span class="keywordtype">string</span> name, <span class="keywordtype">string</span> value)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                <a class="code" href="namespace_outlook.html">Outlook</a>.UserProperty olProperty = olItem.UserProperties[name];</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <span class="keywordflow">if</span> (olProperty == null)</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                    olProperty = olItem.UserProperties.Add(name, <a class="code" href="namespace_outlook.html">Outlook</a>.OlUserPropertyType.olText);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                olProperty.Value = value ?? <span class="keywordtype">string</span>.Empty;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keywordflow">finally</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                this.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#ae0c207e0086d51d9c11ff9baca2d8fba">SaveItem</a>(olItem);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            }</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a5c8a7861444e3dca098054fc34269d3e">  405</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a5c8a7861444e3dca098054fc34269d3e">GetOutlookItems</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.MAPIFolder taskFolder)</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                <a class="code" href="namespace_outlook.html">Outlook</a>.Items olItems = taskFolder.Items.Restrict(<span class="stringliteral">&quot;[MessageClass] = &#39;IPM.Contact&#39;&quot;</span>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                <span class="keywordflow">foreach</span> (<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem oItem in olItems)</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#ab8a2a620b9cbc2b45e2519c148e9e52e">AddOrGetSyncState</a>(oItem);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                Log.Error(<span class="stringliteral">&quot;ThisAddIn.GetOutlookCItems&quot;</span>, ex);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a4c5ca99161393a0a5f94662cd62da246">  430</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a4c5ca99161393a0a5f94662cd62da246">RemoveFromCrm</a>(<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState</a> state)</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        {</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordflow">if</span> (state is <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_sync_state.html">ContactSyncState</a>)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <span class="comment">/* which it most definitely should be */</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                <span class="keywordflow">if</span> (state.ExistedInCrm &amp;&amp; (state.IsDeletedInOutlook || ! state.IsPublic))</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                    <span class="comment">/* remove sync_contact relationship in CRM */</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                    EnsureSyncWithOutlookSetInCRM(state.CrmEntryId, null, <span class="keyword">false</span>);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            }</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                base.RemoveFromCrm(state);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            }</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#ae11edff429850fa164b2919c0934903d">  455</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">override</span> <span class="keywordtype">string</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#ae11edff429850fa164b2919c0934903d">AddOrUpdateItemFromOutlookToCrm</a>(<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState&lt;Outlook.ContactItem&gt;</a> syncState, <span class="keywordtype">string</span> crmType, <span class="keywordtype">string</span> entryId = null)</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <span class="keywordtype">string</span> result = entryId;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            var olItem = syncState.OutlookItem;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <span class="keywordflow">if</span> (this.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#afd9141a746526bfab3c4488bc4103ccc">ShouldAddOrUpdateItemFromOutlookToCrm</a>(olItem))</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                result = base.AddOrUpdateItemFromOutlookToCrm(syncState, crmType, entryId);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <a class="code" href="namespace_outlook.html">Outlook</a>.UserProperty syncProperty = olItem.UserProperties[<span class="stringliteral">&quot;SShouldSync&quot;</span>];</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <span class="keywordtype">string</span> shouldSync = syncProperty == null ?</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    Boolean.TrueString.ToLower() :</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                    syncProperty.Value;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                EnsureSyncWithOutlookSetInCRM(result, syncProperty);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            }</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a0da78ea432c0dd09442d19ec02b4c3b5">  483</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">string</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a0da78ea432c0dd09442d19ec02b4c3b5">ConstructAndDespatchCrmItem</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem olItem, <span class="keywordtype">string</span> crmType, <span class="keywordtype">string</span> entryId)</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html">clsSuiteCRMHelper</a>.<a class="code" href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html#a7bbecd35543154e9785fcfd7788f54e8">SetEntryUnsafe</a>(<span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_proto_items_1_1_proto_contact.html">ProtoContact</a>(olItem).AsNameValues(entryId), crmType);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a20441ed5d82c529e624bba3ef7571e36">  488</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState</a>&lt;<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem&gt; <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a20441ed5d82c529e624bba3ef7571e36">ConstructSyncState</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem oItem)</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_sync_state.html">ContactSyncState</a></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            {</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                OutlookItem = oItem,</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                CrmEntryId = oItem.UserProperties[<span class="stringliteral">&quot;SEntryID&quot;</span>]?.Value.ToString(),</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                OModifiedDate = <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a9a2c3473c4dc60793fed0588c66f8666">ParseDateTimeFromUserProperty</a>(oItem.UserProperties[<span class="stringliteral">&quot;SOModifiedDate&quot;</span>]?.Value.ToString()),</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            };</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">void</span> EnsureSyncWithOutlookSetInCRM(<span class="keywordtype">string</span> contactIdInCRM, <a class="code" href="namespace_outlook.html">Outlook</a>.UserProperty syncProperty, <span class="keywordtype">bool</span> create = <span class="keyword">true</span>)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keywordflow">if</span> (syncProperty == null)</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            {</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                <a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_set_relationship_value.html">eSetRelationshipValue</a> info = <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_set_relationship_value.html">eSetRelationshipValue</a></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                    module1 = <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#abaac66bc3f0333f29f3950607f751462">CrmModule</a>,</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    module1_id = contactIdInCRM,</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                    module2 = <span class="stringliteral">&quot;user_sync&quot;</span>,</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                    module2_id = <a class="code" href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html">clsSuiteCRMHelper</a>.<a class="code" href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html#a050637c0cbd1012cf9cf58c5cb3d179c">GetUserId</a>(),</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    <span class="keyword">delete</span> = create ? 0 : 1</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                };</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                <a class="code" href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html">clsSuiteCRMHelper</a>.<a class="code" href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html#a8f51774a4b5d0dcd199c7a5b72ea4096">SetRelationshipUnsafe</a>(info);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            }</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a00e9d5899f3278a72e9379ec150b9911">  523</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">override</span> <a class="code" href="namespace_outlook.html">Outlook</a>.MAPIFolder <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a00e9d5899f3278a72e9379ec150b9911">GetDefaultFolder</a>()</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a27c5e331d34016150efc67dbbaa78dca">Application</a>.Session.GetDefaultFolder(<a class="code" href="namespace_outlook.html">Outlook</a>.OlDefaultFolders.olFolderContacts);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a83e2ed746cd9ed78c9885efbd78a93be">  528</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">override</span> <span class="keywordtype">string</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a83e2ed746cd9ed78c9885efbd78a93be">GetOutlookEntryId</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem olItem)</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        {</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <span class="keywordflow">return</span> olItem.EntryID;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#aaf2d52ac769269f18ea87f522f23e139">  533</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">override</span> <a class="code" href="namespace_outlook.html">Outlook</a>.OlSensitivity <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#aaf2d52ac769269f18ea87f522f23e139">GetSensitivity</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem item)</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keywordflow">return</span> item.Sensitivity;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a77cb9615d9e777af2efe75a918eecc69">  538</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">bool</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a77cb9615d9e777af2efe75a918eecc69">IsMatch</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.ContactItem olItem, <a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html">eEntryValue</a> crmItem)</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <span class="keywordflow">return</span> olItem.FirstName == crmItem.GetValueAsString(<span class="stringliteral">&quot;first_name&quot;</span>) &amp;&amp;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                olItem.LastName == crmItem.GetValueAsString(<span class="stringliteral">&quot;last_name&quot;</span>) &amp;&amp;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                olItem.Email1Address == crmItem.GetValueAsString(<span class="stringliteral">&quot;email1&quot;</span>);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#afcd9a7a496692c6f88c370e407c7aa25">  552</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">bool</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#afcd9a7a496692c6f88c370e407c7aa25">IsCurrentView</a> =&gt; <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#aa43bada282eea7628099f2f2d75d0ca2">Context</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context.html#a5dcb16ae273015ba82ff59d1ca4f27d8">CurrentFolderItemType</a> == <a class="code" href="namespace_outlook.html">Outlook</a>.OlItemType.olContactItem;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a5aa5685e7b7d66cba2d67cf3394882c8">  562</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">bool</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a5aa5685e7b7d66cba2d67cf3394882c8">PropagatesLocalDeletions</a> =&gt; <span class="keyword">true</span>;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;}</div><div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_sync_state_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_sync_state.html">SuiteCRMAddIn.BusinessLogic.ContactSyncState</a></div><div class="ttdoc">A SyncState for Contact items. </div><div class="ttdef"><b>Definition:</b> <a href="_contact_sync_state_8cs_source.html#l00032">ContactSyncState.cs:32</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_a8c1e906f4a8c369c69e5cdbb73c1cfb2"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a8c1e906f4a8c369c69e5cdbb73c1cfb2">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.ContactItem &gt;::EnsureSynchronisationPropertiesForOutlookItem</a></div><div class="ttdeci">void EnsureSynchronisationPropertiesForOutlookItem(OutlookItemType olItem, string modifiedDate, string type, string entryId)</div><div class="ttdoc">Every Outlook item which is to be synchronised must have a property SOModifiedDate, a property SType, and a property SEntryId, referencing respectively the last time it was modified, the type of CRM item it is to be synchronised with, and the id of the CRM item it is to be synchronised with. </div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00628">Synchroniser.cs:628</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper_html_a7bbecd35543154e9785fcfd7788f54e8"><div class="ttname"><a href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html#a7bbecd35543154e9785fcfd7788f54e8">SuiteCRMClient.clsSuiteCRMHelper.SetEntryUnsafe</a></div><div class="ttdeci">static string SetEntryUnsafe(eNameValue[] data, string moduleName=&quot;Emails&quot;)</div><div class="ttdoc">Sets an entry in CRM and returns the id. &amp;#39;Unsafe&amp;#39; because if it fails (for whatever reason)...</div><div class="ttdef"><b>Definition:</b> <a href="cls_suite_c_r_m_helper_8cs_source.html#l00202">clsSuiteCRMHelper.cs:202</a></div></div>
<div class="ttc" id="namespace_outlook_html"><div class="ttname"><a href="namespace_outlook.html">Outlook</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context_html_a5dcb16ae273015ba82ff59d1ca4f27d8"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context.html#a5dcb16ae273015ba82ff59d1ca4f27d8">SuiteCRMAddIn.BusinessLogic.SyncContext.CurrentFolderItemType</a></div><div class="ttdeci">Outlook.OlItemType CurrentFolderItemType</div><div class="ttdef"><b>Definition:</b> <a href="_sync_context_8cs_source.html#l00046">SyncContext.cs:46</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_a9e06c6056beacdb87f5d807f4739b9ba"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a9e06c6056beacdb87f5d807f4739b9ba">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.ContactItem &gt;::FindMatches</a></div><div class="ttdeci">List&lt; SyncState&lt; OutlookItemType &gt; &gt; FindMatches(eEntryValue crmItem)</div><div class="ttdoc">Find any existing Outlook items which appear to be identical to this CRM item. </div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00864">Synchroniser.cs:864</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_ae0c207e0086d51d9c11ff9baca2d8fba"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#ae0c207e0086d51d9c11ff9baca2d8fba">SuiteCRMAddIn.BusinessLogic.ContactSyncing.SaveItem</a></div><div class="ttdeci">override void SaveItem(Outlook.ContactItem olItem)</div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00078">ContactSyncing.cs:78</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_a5aa5685e7b7d66cba2d67cf3394882c8"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a5aa5685e7b7d66cba2d67cf3394882c8">SuiteCRMAddIn.BusinessLogic.ContactSyncing.PropagatesLocalDeletions</a></div><div class="ttdeci">override bool PropagatesLocalDeletions</div><div class="ttdoc">Return the sensitivity of this outlook item. </div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00562">ContactSyncing.cs:562</a></div></div>
<div class="ttc" id="namespace_system_html"><div class="ttname"><a href="namespace_system.html">System</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_a9a2c3473c4dc60793fed0588c66f8666"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a9a2c3473c4dc60793fed0588c66f8666">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.ContactItem &gt;::ParseDateTimeFromUserProperty</a></div><div class="ttdeci">DateTime ParseDateTimeFromUserProperty(string propertyValue)</div><div class="ttdoc">Parse a date time object from a user property, assuming the ISO 8601 date-time format but ommitting t...</div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00767">Synchroniser.cs:767</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_acc7036a95cd34952cf01c774b1fcefc2"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#acc7036a95cd34952cf01c774b1fcefc2">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.ContactItem &gt;::MergeRecordsFromCrm</a></div><div class="ttdeci">virtual void MergeRecordsFromCrm(Outlook.MAPIFolder folder, string crmModule, HashSet&lt; SyncState&lt; OutlookItemType &gt;&gt; untouched)</div><div class="ttdoc">Fetch records in pages from CRM, and merge them into Outlook. </div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00785">Synchroniser.cs:785</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_afff6b1974cece09abe1eaae8417e33a8"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#afff6b1974cece09abe1eaae8417e33a8">SuiteCRMAddIn.BusinessLogic.ContactSyncing.SyncFolder</a></div><div class="ttdeci">override void SyncFolder(Outlook.MAPIFolder folder, string crmModule)</div><div class="ttdoc">Synchronise items in the specified folder with the specified SuiteCRM module. </div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00088">ContactSyncing.cs:88</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_a4c5ca99161393a0a5f94662cd62da246"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a4c5ca99161393a0a5f94662cd62da246">SuiteCRMAddIn.BusinessLogic.ContactSyncing.RemoveFromCrm</a></div><div class="ttdeci">override void RemoveFromCrm(SyncState state)</div><div class="ttdoc">(Don&amp;#39;t actually) remove the item implied by this sync state from CRM. </div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00430">ContactSyncing.cs:430</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction_html_aee195368e938ed8e05fa3ec669838c06"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html#aee195368e938ed8e05fa3ec669838c06">SuiteCRMAddIn.BusinessLogic.SyncDirection.Direction</a></div><div class="ttdeci">Direction</div><div class="ttdoc">The actual directions </div><div class="ttdef"><b>Definition:</b> <a href="_sync_direction_8cs_source.html#l00034">SyncDirection.cs:34</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_client_1_1_logging_html"><div class="ttname"><a href="namespace_suite_c_r_m_client_1_1_logging.html">SuiteCRMClient.Logging</a></div><div class="ttdef"><b>Definition:</b> <a href="_abstract_logger_8cs_source.html#l00023">AbstractLogger.cs:23</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_a27c5e331d34016150efc67dbbaa78dca"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a27c5e331d34016150efc67dbbaa78dca">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.ContactItem &gt;::Application</a></div><div class="ttdeci">Outlook.Application Application</div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00181">Synchroniser.cs:181</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html">SuiteCRMAddIn.BusinessLogic.ContactSyncing</a></div><div class="ttdoc">An agent which synchronises Outlook Contact items with CRM. </div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00039">ContactSyncing.cs:39</a></div></div>
<div class="ttc" id="namespace_exception_html"><div class="ttname"><a href="namespace_exception.html">Exception</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_client_1_1_r_e_s_t_objects_html"><div class="ttname"><a href="namespace_suite_c_r_m_client_1_1_r_e_s_t_objects.html">SuiteCRMClient.RESTObjects</a></div><div class="ttdoc">The RESTObjects package contains classes which may be deserialised from JSON messages sent by CRM...</div><div class="ttdef"><b>Definition:</b> <a href="_suite_c_r_m_client_2_r_e_s_t_objects_2_documentation_8cs_source.html#l00015">Documentation.cs:15</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_a28c8d1b0f9b3e13511bac132221b6c2c"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a28c8d1b0f9b3e13511bac132221b6c2c">SuiteCRMAddIn.BusinessLogic.ContactSyncing.EnsureSynchronisationPropertyForOutlookItem</a></div><div class="ttdeci">override void EnsureSynchronisationPropertyForOutlookItem(Outlook.ContactItem olItem, string name, string value)</div><div class="ttdoc">Ensure that this Outlook item has a property of this name with this value. </div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00387">ContactSyncing.cs:387</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value_html"><div class="ttname"><a href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html">SuiteCRMClient.RESTObjects.eEntryValue</a></div><div class="ttdef"><b>Definition:</b> <a href="e_entry_value_8cs_source.html#l00032">eEntryValue.cs:32</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_aa13c973be68574d93d46bb35fd634e5f"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#aa13c973be68574d93d46bb35fd634e5f">SuiteCRMAddIn.BusinessLogic.ContactSyncing.TransmissionLock</a></div><div class="ttdeci">override object TransmissionLock</div><div class="ttdoc">Allow my parent class to access my transmission lock object. </div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00063">ContactSyncing.cs:63</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_a20441ed5d82c529e624bba3ef7571e36"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a20441ed5d82c529e624bba3ef7571e36">SuiteCRMAddIn.BusinessLogic.ContactSyncing.ConstructSyncState</a></div><div class="ttdeci">override SyncState&lt; Outlook.ContactItem &gt; ConstructSyncState(Outlook.ContactItem oItem)</div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00488">ContactSyncing.cs:488</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_a77cb9615d9e777af2efe75a918eecc69"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a77cb9615d9e777af2efe75a918eecc69">SuiteCRMAddIn.BusinessLogic.ContactSyncing.IsMatch</a></div><div class="ttdeci">override bool IsMatch(Outlook.ContactItem olItem, eEntryValue crmItem)</div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00538">ContactSyncing.cs:538</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_a83e2ed746cd9ed78c9885efbd78a93be"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a83e2ed746cd9ed78c9885efbd78a93be">SuiteCRMAddIn.BusinessLogic.ContactSyncing.GetOutlookEntryId</a></div><div class="ttdeci">override string GetOutlookEntryId(Outlook.ContactItem olItem)</div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00528">ContactSyncing.cs:528</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_afcd9a7a496692c6f88c370e407c7aa25"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#afcd9a7a496692c6f88c370e407c7aa25">SuiteCRMAddIn.BusinessLogic.ContactSyncing.IsCurrentView</a></div><div class="ttdeci">override bool IsCurrentView</div><div class="ttdoc">True if the currently open tab in Outlook displays items of my item type. </div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00552">ContactSyncing.cs:552</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_afd9141a746526bfab3c4488bc4103ccc"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#afd9141a746526bfab3c4488bc4103ccc">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.ContactItem &gt;::ShouldAddOrUpdateItemFromOutlookToCrm</a></div><div class="ttdeci">bool ShouldAddOrUpdateItemFromOutlookToCrm(OutlookItemType olItem)</div><div class="ttdoc">Perform all the necessary checking before adding or updating an item on CRM. </div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00274">Synchroniser.cs:274</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_a5c8a7861444e3dca098054fc34269d3e"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a5c8a7861444e3dca098054fc34269d3e">SuiteCRMAddIn.BusinessLogic.ContactSyncing.GetOutlookItems</a></div><div class="ttdeci">override void GetOutlookItems(Outlook.MAPIFolder taskFolder)</div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00405">ContactSyncing.cs:405</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_acc0767f43a7c30dea23d8c6023edd2ab"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#acc0767f43a7c30dea23d8c6023edd2ab">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.ContactItem &gt;::fetchQueryPrefix</a></div><div class="ttdeci">string fetchQueryPrefix</div><div class="ttdoc">The prefix for the fetch query, used in FetchRecordsFromCrm, q.v. </div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00074">Synchroniser.cs:74</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_set_relationship_value_html"><div class="ttname"><a href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_set_relationship_value.html">SuiteCRMClient.RESTObjects.eSetRelationshipValue</a></div><div class="ttdef"><b>Definition:</b> <a href="e_set_relationship_value_8cs_source.html#l00027">eSetRelationshipValue.cs:27</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_ae11edff429850fa164b2919c0934903d"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#ae11edff429850fa164b2919c0934903d">SuiteCRMAddIn.BusinessLogic.ContactSyncing.AddOrUpdateItemFromOutlookToCrm</a></div><div class="ttdeci">override string AddOrUpdateItemFromOutlookToCrm(SyncState&lt; Outlook.ContactItem &gt; syncState, string crmType, string entryId=null)</div><div class="ttdoc">Add the Outlook item referenced by this sync state, which may not exist in CRM, to CRM...</div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00455">ContactSyncing.cs:455</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_aa43bada282eea7628099f2f2d75d0ca2"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#aa43bada282eea7628099f2f2d75d0ca2">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.ContactItem &gt;::Context</a></div><div class="ttdeci">SyncContext Context</div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00179">Synchroniser.cs:179</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_a0da78ea432c0dd09442d19ec02b4c3b5"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a0da78ea432c0dd09442d19ec02b4c3b5">SuiteCRMAddIn.BusinessLogic.ContactSyncing.ConstructAndDespatchCrmItem</a></div><div class="ttdeci">override string ConstructAndDespatchCrmItem(Outlook.ContactItem olItem, string crmType, string entryId)</div><div class="ttdoc">Construct a JSON packet representing this Outlook item, and despatch it to CRM. </div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00483">ContactSyncing.cs:483</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html">SuiteCRMAddIn.BusinessLogic.SyncDirection</a></div><div class="ttdoc">A direction in which things may be synchronised. Directions are named with respect to CRM...</div><div class="ttdef"><b>Definition:</b> <a href="_sync_direction_8cs_source.html#l00029">SyncDirection.cs:29</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_a00e9d5899f3278a72e9379ec150b9911"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a00e9d5899f3278a72e9379ec150b9911">SuiteCRMAddIn.BusinessLogic.ContactSyncing.GetDefaultFolder</a></div><div class="ttdeci">override Outlook.MAPIFolder GetDefaultFolder()</div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00523">ContactSyncing.cs:523</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper_html"><div class="ttname"><a href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html">SuiteCRMClient.clsSuiteCRMHelper</a></div><div class="ttdef"><b>Definition:</b> <a href="cls_suite_c_r_m_helper_8cs_source.html#l00035">clsSuiteCRMHelper.cs:35</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_a0ea303cb4210eb22c79d6f8f0d859a39"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a0ea303cb4210eb22c79d6f8f0d859a39">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.ContactItem &gt;::ItemsSyncState</a></div><div class="ttdeci">ThreadSafeList&lt; SyncState&lt; OutlookItemType &gt; &gt; ItemsSyncState</div><div class="ttdoc">List of the synchronisation state of all items which may require synchronisation. ...</div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00188">Synchroniser.cs:188</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_a9ec0ba9a0d4a426fa90b6856f2c1b0e9"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a9ec0ba9a0d4a426fa90b6856f2c1b0e9">SuiteCRMAddIn.BusinessLogic.ContactSyncing.LogItemAction</a></div><div class="ttdeci">override void LogItemAction(Outlook.ContactItem olItem, string message)</div><div class="ttdoc">Log a message regarding this Outlook item, with detail of the item. </div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00240">ContactSyncing.cs:240</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_a8612fe5996262db88cad121c4580ba7c"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a8612fe5996262db88cad121c4580ba7c">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.ContactItem &gt;::permissionsCache</a></div><div class="ttdeci">readonly CRMPermissionsCache&lt; OutlookItemType &gt; permissionsCache</div><div class="ttdoc">A cache for CRM premissions to prevent continually asking for them. </div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00093">Synchroniser.cs:93</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper_html_a050637c0cbd1012cf9cf58c5cb3d179c"><div class="ttname"><a href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html#a050637c0cbd1012cf9cf58c5cb3d179c">SuiteCRMClient.clsSuiteCRMHelper.GetUserId</a></div><div class="ttdeci">static string GetUserId()</div><div class="ttdoc">Return the CRM id of the current user. </div><div class="ttdef"><b>Definition:</b> <a href="cls_suite_c_r_m_helper_8cs_source.html#l00156">clsSuiteCRMHelper.cs:156</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_a603e067624ee2112311c34b85625279f"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a603e067624ee2112311c34b85625279f">SuiteCRMAddIn.BusinessLogic.ContactSyncing.Direction</a></div><div class="ttdeci">override SyncDirection.Direction Direction</div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00052">ContactSyncing.cs:52</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_proto_items_1_1_proto_contact_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_proto_items_1_1_proto_contact.html">SuiteCRMAddIn.ProtoItems.ProtoContact</a></div><div class="ttdoc">Broadly, a C# representation of a CRM contact. </div><div class="ttdef"><b>Definition:</b> <a href="_proto_contact_8cs_source.html#l00013">ProtoContact.cs:13</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_a89a4299b5dac6324d218467202dfe30e"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a89a4299b5dac6324d218467202dfe30e">SuiteCRMAddIn.BusinessLogic.ContactSyncing.ContactSyncing</a></div><div class="ttdeci">ContactSyncing(string name, SyncContext context)</div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00046">ContactSyncing.cs:46</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context.html">SuiteCRMAddIn.BusinessLogic.SyncContext</a></div><div class="ttdoc">A bundle of handles onto all the things which are needed to allow synchronisation to take place...</div><div class="ttdef"><b>Definition:</b> <a href="_sync_context_8cs_source.html#l00031">SyncContext.cs:31</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_a22031f77a31ab4d27818815ebc85786d"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a22031f77a31ab4d27818815ebc85786d">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.ContactItem &gt;::GetExistingSyncState</a></div><div class="ttdeci">SyncState&lt; OutlookItemType &gt; GetExistingSyncState(OutlookItemType olItem)</div><div class="ttdoc">Get the existing sync state representing this item, if it exists, else null. </div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00503">Synchroniser.cs:503</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_a8a0d14bba071fb1083d9be9b497de642"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a8a0d14bba071fb1083d9be9b497de642">SuiteCRMAddIn.BusinessLogic.ContactSyncing.AddOrUpdateItemFromCrmToOutlook</a></div><div class="ttdeci">override SyncState&lt; Outlook.ContactItem &gt; AddOrUpdateItemFromCrmToOutlook(Outlook.MAPIFolder folder, string crmType, eEntryValue crmItem)</div><div class="ttdoc">Update a single item in the specified Outlook folder with changes from CRM. If the item does not exis...</div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00121">ContactSyncing.cs:121</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_a6cd13ab6212d4c852e838fd50e7751b6"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#a6cd13ab6212d4c852e838fd50e7751b6">SuiteCRMAddIn.BusinessLogic.ContactSyncing.DefaultCrmModule</a></div><div class="ttdeci">override string DefaultCrmModule</div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00071">ContactSyncing.cs:71</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_a483e9fe3f7b8356dd85b53d7d4014f50"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a483e9fe3f7b8356dd85b53d7d4014f50">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.ContactItem &gt;::ResolveUnmatchedItems</a></div><div class="ttdeci">void ResolveUnmatchedItems(IEnumerable&lt; SyncState&lt; OutlookItemType &gt;&gt; itemsToResolve, string crmModule)</div><div class="ttdoc">Given a list of items which exist in Outlook but are missing from CRM, resolve how to handle them...</div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00252">Synchroniser.cs:252</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SuiteCRMAddIn.BusinessLogic.SyncState</a></div><div class="ttdoc">Superclass for SyncState&lt;T&gt;, q.v.. </div><div class="ttdef"><b>Definition:</b> <a href="_sync_state_8cs_source.html#l00033">SyncState.cs:33</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_client_html"><div class="ttname"><a href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a></div><div class="ttdoc">SuiteCRMClient is a client library for the SuiteCRM JSON API. </div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html">SuiteCRMAddIn.BusinessLogic.Synchroniser</a></div><div class="ttdoc">Synchronise items of the class for which I am responsible. </div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00043">Synchroniser.cs:43</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_add_in_html"><div class="ttname"><a href="namespace_suite_c_r_m_add_in.html">SuiteCRMAddIn</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper_html_a8f51774a4b5d0dcd199c7a5b72ea4096"><div class="ttname"><a href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html#a8f51774a4b5d0dcd199c7a5b72ea4096">SuiteCRMClient.clsSuiteCRMHelper.SetRelationshipUnsafe</a></div><div class="ttdeci">static bool SetRelationshipUnsafe(eSetRelationshipValue info)</div><div class="ttdoc">Sets a CRM relationship and returns boolean success. &amp;#39;Unsafe&amp;#39; because most callers ignore the result...</div><div class="ttdef"><b>Definition:</b> <a href="cls_suite_c_r_m_helper_8cs_source.html#l00306">clsSuiteCRMHelper.cs:306</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_aaf2d52ac769269f18ea87f522f23e139"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#aaf2d52ac769269f18ea87f522f23e139">SuiteCRMAddIn.BusinessLogic.ContactSyncing.GetSensitivity</a></div><div class="ttdeci">override Outlook.OlSensitivity GetSensitivity(Outlook.ContactItem item)</div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00533">ContactSyncing.cs:533</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing_html_abaac66bc3f0333f29f3950607f751462"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_contact_syncing.html#abaac66bc3f0333f29f3950607f751462">SuiteCRMAddIn.BusinessLogic.ContactSyncing.CrmModule</a></div><div class="ttdeci">const string CrmModule</div><div class="ttdoc">The module I synchronise with. </div><div class="ttdef"><b>Definition:</b> <a href="_contact_syncing_8cs_source.html#l00044">ContactSyncing.cs:44</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_ab8a2a620b9cbc2b45e2519c148e9e52e"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#ab8a2a620b9cbc2b45e2519c148e9e52e">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.ContactItem &gt;::AddOrGetSyncState</a></div><div class="ttdeci">SyncState&lt; OutlookItemType &gt; AddOrGetSyncState(OutlookItemType olItem)</div><div class="ttdoc">Find the SyncState whose item is this item; if it does not already exist, construct and return it...</div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00458">Synchroniser.cs:458</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_3341eda471cc1faa5052bfebf1426198.html">SuiteCRMAddIn</a></li><li class="navelem"><a class="el" href="dir_3fb47a1533c09fa7ca776045a50683b4.html">BusinessLogic</a></li><li class="navelem"><a class="el" href="_contact_syncing_8cs.html">ContactSyncing.cs</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
