<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>SuiteCRM Outlook Add-in: SuiteCRMAddIn/BusinessLogic/TaskSyncing.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="CompanyLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SuiteCRM Outlook Add-in
   &#160;<span id="projectnumber">3.0.4.0</span>
   </div>
   <div id="projectbrief">An outlook add-in which allows synchronisation with SuiteCRM</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_task_syncing_8cs_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">TaskSyncing.cs</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_task_syncing_8cs.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_suite_c_r_m_add_in.html">SuiteCRMAddIn</a>.BusinessLogic</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_suite_c_r_m_add_in.html">SuiteCRMAddIn</a>.<a class="code" href="namespace_suite_c_r_m_add_in_1_1_proto_items.html">ProtoItems</a>;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a>.<a class="code" href="namespace_suite_c_r_m_client_1_1_logging.html">Logging</a>;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a>.<a class="code" href="namespace_suite_c_r_m_client_1_1_r_e_s_t_objects.html">RESTObjects</a>;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Collections.Generic;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Runtime.InteropServices;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespace_outlook.html">Outlook</a> = Microsoft.Office.Interop.Outlook;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html">   37</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html">TaskSyncing</a>: <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html">Synchroniser</a>&lt;Outlook.TaskItem&gt;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    {</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#abdadd3dfda9dd4705d0f25da315d12b4">   42</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#abdadd3dfda9dd4705d0f25da315d12b4">CrmModule</a> = <span class="stringliteral">&quot;Tasks&quot;</span>;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a2b059d9877f7222cf924244e4c229e98">   44</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a2b059d9877f7222cf924244e4c229e98">TaskSyncing</a>(<span class="keywordtype">string</span> name, <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context.html">SyncContext</a> context)</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            : base(name, context)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            this.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#acc0767f43a7c30dea23d8c6023edd2ab">fetchQueryPrefix</a> = <span class="keywordtype">string</span>.Empty;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        }</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">object</span> txLock = <span class="keyword">new</span> object();</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">object</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a8a33d4ec8cdb1715295928c5e69308c8">TransmissionLock</a></div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a8a33d4ec8cdb1715295928c5e69308c8">   59</a></span>&#160;        {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <span class="keyword">get</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                <span class="keywordflow">return</span> txLock;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            }</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keyword">public</span> <span class="keyword">override</span> <span class="keywordtype">string</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#af216ea175725dcc03cdeed105d908d8f">DefaultCrmModule</a></div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#af216ea175725dcc03cdeed105d908d8f">   67</a></span>&#160;        {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <span class="keyword">get</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html">TaskSyncing</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#abdadd3dfda9dd4705d0f25da315d12b4">CrmModule</a>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            }</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a1ba9633b7bee7b424510c387b2fd6636">   74</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">override</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html">SyncDirection</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html#aee195368e938ed8e05fa3ec669838c06">Direction</a> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a1ba9633b7bee7b424510c387b2fd6636">Direction</a> =&gt; Properties.Settings.Default.SyncCalendar;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keyword">private</span> <a class="code" href="namespace_outlook.html">Outlook</a>.OlImportance GetImportance(<span class="keywordtype">string</span> sImportance)</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <a class="code" href="namespace_outlook.html">Outlook</a>.OlImportance oPriority = <a class="code" href="namespace_outlook.html">Outlook</a>.OlImportance.olImportanceLow;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordflow">switch</span> (sImportance)</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&quot;High&quot;</span>:</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                    oPriority = <a class="code" href="namespace_outlook.html">Outlook</a>.OlImportance.olImportanceHigh;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Medium&quot;</span>:</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                    oPriority = <a class="code" href="namespace_outlook.html">Outlook</a>.OlImportance.olImportanceNormal;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keywordflow">return</span> oPriority;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keyword">private</span> <a class="code" href="namespace_outlook.html">Outlook</a>.OlTaskStatus GetStatus(<span class="keywordtype">string</span> sStatus)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <a class="code" href="namespace_outlook.html">Outlook</a>.OlTaskStatus oStatus = <a class="code" href="namespace_outlook.html">Outlook</a>.OlTaskStatus.olTaskNotStarted;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="keywordflow">switch</span> (sStatus)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&quot;In Progress&quot;</span>:</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                    oStatus = <a class="code" href="namespace_outlook.html">Outlook</a>.OlTaskStatus.olTaskInProgress;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Completed&quot;</span>:</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                    oStatus = <a class="code" href="namespace_outlook.html">Outlook</a>.OlTaskStatus.olTaskComplete;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&quot;Deferred&quot;</span>:</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                    oStatus = <a class="code" href="namespace_outlook.html">Outlook</a>.OlTaskStatus.olTaskDeferred;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <span class="keywordflow">return</span> oStatus;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a214d7e1a0000e29128954b3e6516fbb8">  109</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a214d7e1a0000e29128954b3e6516fbb8">SaveItem</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem olItem)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            olItem.Save();</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#ac49de51ba359f2bf8567a6630e0b4183">LogItemAction</a>(olItem, <span class="stringliteral">&quot;TaskSyncing.SaveItem, saved item&quot;</span>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a7382f87a4a0d953a72f84857a094a335">  120</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a7382f87a4a0d953a72f84857a094a335">SyncFolder</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.MAPIFolder folder, <span class="keywordtype">string</span> crmModule)</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            Log.Info($<span class="stringliteral">&quot;ContactSyncing.SyncFolder: &#39;{folder}&#39;&quot;</span>);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                var untouched = <span class="keyword">new</span> HashSet&lt;<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState</a>&lt;<a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem&gt;&gt;(<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a0ea303cb4210eb22c79d6f8f0d859a39">ItemsSyncState</a>);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#acc7036a95cd34952cf01c774b1fcefc2">MergeRecordsFromCrm</a>(folder, crmModule, untouched);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a483e9fe3f7b8356dd85b53d7d4014f50">ResolveUnmatchedItems</a>(untouched);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                    Log.Error(<span class="stringliteral">&quot;TaskSyncing.SyncFolder&quot;</span>, ex);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                Log.Error(<span class="stringliteral">&quot;TaskSyncing.SyncFolder&quot;</span>, ex);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#ac49de51ba359f2bf8567a6630e0b4183">  150</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#ac49de51ba359f2bf8567a6630e0b4183">LogItemAction</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem olItem, <span class="keywordtype">string</span> message)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <a class="code" href="namespace_outlook.html">Outlook</a>.UserProperty olPropertyEntryId = olItem.UserProperties[<span class="stringliteral">&quot;SEntryID&quot;</span>];</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="keywordtype">string</span> crmId = olPropertyEntryId == null ?</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                    <span class="stringliteral">&quot;[not present]&quot;</span> :</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    olPropertyEntryId.Value;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                Log.Info($<span class="stringliteral">&quot;{0}:\n\tOutlook Id  : {olItem.EntryID}\n\tCRM Id      : {crmId}\n\tSubject    : &#39;{olItem.Subject}&#39;\n\tStatus      : {olItem.Status}&quot;</span>);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="keywordflow">catch</span> (COMException)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                <span class="comment">// Ignore: happens if the outlook item is already deleted.</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">// TODO: this is very horrible and should be reworked.</span></div><div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a2024b479b443ef00135870d5bbbfa4be">  167</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState</a>&lt;<a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem&gt; <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a2024b479b443ef00135870d5bbbfa4be">AddOrUpdateItemFromCrmToOutlook</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.MAPIFolder tasksFolder, <span class="keywordtype">string</span> crmType, <a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html">eEntryValue</a> crmItem)</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState</a>&lt;<a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem&gt; result = null;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            Log.Debug($<span class="stringliteral">&quot;TaskSyncing.AddOrUpdateItemFromCrmToOutlook\n\tSubject: {crmItem.GetValueAsString(&quot;</span>name<span class="stringliteral">&quot;)}\n\tCurrent user id {clsSuiteCRMHelper.GetUserId()}\n\tAssigned user id: {crmItem.GetValueAsString(&quot;</span>assigned_user_id<span class="stringliteral">&quot;)}&quot;</span>);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html">clsSuiteCRMHelper</a>.<a class="code" href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html#a050637c0cbd1012cf9cf58c5cb3d179c">GetUserId</a>() == crmItem.GetValueAsString(<span class="stringliteral">&quot;assigned_user_id&quot;</span>))</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                DateTime date_start = crmItem.GetValueAsDateTime(<span class="stringliteral">&quot;date_start&quot;</span>);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                DateTime date_due = crmItem.GetValueAsDateTime(<span class="stringliteral">&quot;date_due&quot;</span>);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <span class="keywordtype">string</span> time_start =</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                        TimeSpan.FromHours(date_start.Hour)</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                            .Add(TimeSpan.FromMinutes(date_start.Minute))</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                            .ToString(<span class="stringliteral">@&quot;hh\:mm&quot;</span>);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <span class="keywordtype">string</span> time_due = TimeSpan.FromHours(date_due.Hour)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                .Add(TimeSpan.FromMinutes(date_due.Minute))</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                .ToString(<span class="stringliteral">@&quot;hh\:mm&quot;</span>);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                var syncState = this.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a22031f77a31ab4d27818815ebc85786d">GetExistingSyncState</a>(crmItem);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                <span class="keywordflow">if</span> (syncState == null)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    <span class="comment">/* check for howlaround */</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                    var matches = this.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a9e06c6056beacdb87f5d807f4739b9ba">FindMatches</a>(crmItem);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                    <span class="keywordflow">if</span> (matches.Count == 0)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                        <span class="comment">/* didn&#39;t find it, so add it to Outlook */</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                        result = AddNewItemFromCrmToOutlook(tasksFolder, crmItem, date_start, date_due, time_start, time_due);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                    {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                        this.Log.Warn($<span class="stringliteral">&quot;Howlaround detected? Task &#39;{crmItem.GetValueAsString(&quot;</span>name<span class="stringliteral">&quot;)}&#39; offered with id {crmItem.GetValueAsString(&quot;</span><span class="keywordtype">id</span><span class="stringliteral">&quot;)}, expected {matches[0].CrmEntryId}, {matches.Count} duplicates&quot;</span>);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                    }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                    result = UpdateExistingOutlookItemFromCrm(crmItem, date_start, date_due, time_start, time_due, syncState);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keyword">private</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState</a>&lt;<a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem&gt; UpdateExistingOutlookItemFromCrm(<a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html">eEntryValue</a> crmItem, DateTime? date_start, DateTime? date_due, <span class="keywordtype">string</span> time_start, <span class="keywordtype">string</span> time_due, <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState&lt;Outlook.TaskItem&gt;</a> syncStateForItem)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">if</span> (!syncStateForItem.IsDeletedInOutlook)</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem olItem = syncStateForItem.OutlookItem;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <a class="code" href="namespace_outlook.html">Outlook</a>.UserProperty oProp = olItem.UserProperties[<span class="stringliteral">&quot;SOModifiedDate&quot;</span>];</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <span class="keywordflow">if</span> (oProp.Value != crmItem.GetValueAsString(<span class="stringliteral">&quot;date_modified&quot;</span>))</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    SetOutlookItemPropertiesFromCrmItem(crmItem, date_start, date_due, time_start, time_due, olItem);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                syncStateForItem.OModifiedDate = DateTime.ParseExact(crmItem.GetValueAsString(<span class="stringliteral">&quot;date_modified&quot;</span>), <span class="stringliteral">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>, null);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keywordflow">return</span> syncStateForItem;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> SetOutlookItemPropertiesFromCrmItem(<a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html">eEntryValue</a> crmItem, DateTime? date_start, DateTime? date_due, <span class="keywordtype">string</span> time_start, <span class="keywordtype">string</span> time_due, <a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem olItem)</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                olItem.Subject = crmItem.GetValueAsString(<span class="stringliteral">&quot;name&quot;</span>);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                    <span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrWhiteSpace(crmItem.GetValueAsString(<span class="stringliteral">&quot;date_start&quot;</span>)))</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                    {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                        Log.Warn(<span class="stringliteral">&quot;\ttItem.StartDate= &quot;</span> + olItem.StartDate + <span class="stringliteral">&quot;, date_start=&quot;</span> + date_start);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                        olItem.StartDate = date_start.Value;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                    }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> fail)</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                    <span class="comment">/* you (sometimes? always?) can&#39;t set the start or due dates of tasks. Investigate. */</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                    Log.Error($<span class="stringliteral">&quot;TaskSyncing.SetOutlookItemPropertiesFromCrmItem: Failed to set start date on task because {fail.Message}&quot;</span>, fail);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    <span class="keywordflow">if</span> (!<span class="keywordtype">string</span>.IsNullOrWhiteSpace(crmItem.GetValueAsString(<span class="stringliteral">&quot;date_due&quot;</span>)))</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                        olItem.DueDate = date_due.Value; <span class="comment">// DateTime.Parse(dResult.date_due.value.ToString());</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> fail)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                    <span class="comment">/* you (sometimes? always?) can&#39;t set the start or due dates of tasks. Investigate. */</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                    Log.Error($<span class="stringliteral">&quot;TaskSyncing.SetOutlookItemPropertiesFromCrmItem: Failed to set due date on task because {fail.Message}&quot;</span>, fail);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <span class="keywordtype">string</span> body = crmItem.GetValueAsString(<span class="stringliteral">&quot;description&quot;</span>);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                olItem.Body = <span class="keywordtype">string</span>.Concat(body, <span class="stringliteral">&quot;#&lt;&quot;</span>, time_start, <span class="stringliteral">&quot;#&quot;</span>, time_due);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                olItem.Status = GetStatus(crmItem.GetValueAsString(<span class="stringliteral">&quot;status&quot;</span>));</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                olItem.Importance = GetImportance(crmItem.GetValueAsString(<span class="stringliteral">&quot;priority&quot;</span>));</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a8c1e906f4a8c369c69e5cdbb73c1cfb2">EnsureSynchronisationPropertiesForOutlookItem</a>(olItem, crmItem.GetValueAsString(<span class="stringliteral">&quot;date_modified&quot;</span>), <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#af216ea175725dcc03cdeed105d908d8f">DefaultCrmModule</a>, crmItem.<a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html#a338413e27f0a446a3fdd15ba6c7b047b">id</a>);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="keywordflow">finally</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                olItem.Save();</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keyword">private</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState</a>&lt;<a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem&gt; AddNewItemFromCrmToOutlook(<a class="code" href="namespace_outlook.html">Outlook</a>.MAPIFolder tasksFolder, <a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html">eEntryValue</a> crmItem, DateTime? date_start, DateTime? date_due, <span class="keywordtype">string</span> time_start, <span class="keywordtype">string</span> time_due)</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem olItem = tasksFolder.Items.Add(<a class="code" href="namespace_outlook.html">Outlook</a>.OlItemType.olTaskItem);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_sync_state.html">TaskSyncState</a> newState = null;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                this.SetOutlookItemPropertiesFromCrmItem(crmItem, date_start, date_due, time_start, time_due, olItem);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                newState = <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_sync_state.html">TaskSyncState</a></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                    OutlookItem = olItem,</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                    OModifiedDate = DateTime.ParseExact(crmItem.GetValueAsString(<span class="stringliteral">&quot;date_modified&quot;</span>), <span class="stringliteral">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>, null),</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                    CrmEntryId = crmItem.GetValueAsString(<span class="stringliteral">&quot;id&quot;</span>),</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                };</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a0ea303cb4210eb22c79d6f8f0d859a39">ItemsSyncState</a>.Add(newState);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="keywordflow">finally</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                olItem.Save();</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#ac49de51ba359f2bf8567a6630e0b4183">LogItemAction</a>(olItem, <span class="stringliteral">&quot;TaskSyncing.AddNewItemFromCrmToOutlook, saved item&quot;</span>);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="keywordflow">return</span> newState;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a5ffca39ee66e0c50f42ea434e3f9af9d">  307</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">string</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a5ffca39ee66e0c50f42ea434e3f9af9d">ConstructAndDespatchCrmItem</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem olItem, <span class="keywordtype">string</span> crmType, <span class="keywordtype">string</span> entryId)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html">clsSuiteCRMHelper</a>.<a class="code" href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html#a7bbecd35543154e9785fcfd7788f54e8">SetEntryUnsafe</a>(<span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_proto_items_1_1_proto_task.html">ProtoTask</a>(olItem).AsNameValues(entryId), crmType);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a5120593ccd24bdd38cd5609ed0c5a504">  313</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a5120593ccd24bdd38cd5609ed0c5a504">GetOutlookItems</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.MAPIFolder taskFolder)</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <a class="code" href="namespace_outlook.html">Outlook</a>.Items items = taskFolder.Items; <span class="comment">//.Restrict(&quot;[MessageClass] = &#39;IPM.Task&#39;&quot; + GetStartDateString());</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                <span class="keywordflow">foreach</span> (<a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem oItem in items)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    <span class="keywordflow">if</span> (oItem.DueDate &lt; DateTime.Now.AddDays(-5))</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                    <a class="code" href="namespace_outlook.html">Outlook</a>.UserProperty oProp = oItem.UserProperties[<span class="stringliteral">&quot;SOModifiedDate&quot;</span>];</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                    <span class="keywordflow">if</span> (oProp != null)</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                    {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                        <a class="code" href="namespace_outlook.html">Outlook</a>.UserProperty oProp2 = oItem.UserProperties[<span class="stringliteral">&quot;SEntryID&quot;</span>];</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                        <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a0ea303cb4210eb22c79d6f8f0d859a39">ItemsSyncState</a>.Add(<span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_sync_state.html">TaskSyncState</a></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                        {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                            OutlookItem = oItem,</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                            <span class="comment">//OModifiedDate = &quot;Fresh&quot;,</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                            OModifiedDate = DateTime.UtcNow,</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                            CrmEntryId = oProp2.Value.ToString()</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                        });</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                    }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                        <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a0ea303cb4210eb22c79d6f8f0d859a39">ItemsSyncState</a>.Add(<span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_sync_state.html">TaskSyncState</a></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                        {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                            OutlookItem = oItem</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                        });</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keywordflow">catch</span> (<a class="code" href="namespace_exception.html">Exception</a> ex)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                Log.Error(<span class="stringliteral">&quot;ThisAddIn.GetOutlookTItems&quot;</span>, ex);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a8c5a8adf1dff2b0d9074b2bd75ec27dd">  351</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a8c5a8adf1dff2b0d9074b2bd75ec27dd">EnsureSynchronisationPropertyForOutlookItem</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem olItem, <span class="keywordtype">string</span> name, <span class="keywordtype">string</span> value)</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordflow">try</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <a class="code" href="namespace_outlook.html">Outlook</a>.UserProperty olProperty = olItem.UserProperties[name];</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <span class="keywordflow">if</span> (olProperty == null)</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                    olProperty = olItem.UserProperties.Add(name, <a class="code" href="namespace_outlook.html">Outlook</a>.OlUserPropertyType.olText);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                }</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                olProperty.Value = value ?? <span class="keywordtype">string</span>.Empty;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordflow">finally</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                this.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a214d7e1a0000e29128954b3e6516fbb8">SaveItem</a>(olItem);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a8fdcfc454a40b663c20842f70ab57f8b">  369</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">override</span> <a class="code" href="namespace_outlook.html">Outlook</a>.MAPIFolder <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a8fdcfc454a40b663c20842f70ab57f8b">GetDefaultFolder</a>()</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a27c5e331d34016150efc67dbbaa78dca">Application</a>.Session.GetDefaultFolder(<a class="code" href="namespace_outlook.html">Outlook</a>.OlDefaultFolders.olFolderTasks);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a0e5f996da330d5139080fb1622fd4133">  374</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SyncState</a>&lt;<a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem&gt; <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a0e5f996da330d5139080fb1622fd4133">ConstructSyncState</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem olItem)</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_sync_state.html">TaskSyncState</a></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                OutlookItem = olItem,</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                CrmEntryId = olItem.UserProperties[<span class="stringliteral">&quot;SEntryID&quot;</span>]?.Value.ToString(),</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                OModifiedDate = <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a9a2c3473c4dc60793fed0588c66f8666">ParseDateTimeFromUserProperty</a>(olItem.UserProperties[<span class="stringliteral">&quot;SOModifiedDate&quot;</span>]?.Value.ToString()),</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            };</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#aa0db856a47893931da64e43f5a74708c">  384</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">override</span> <span class="keywordtype">string</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#aa0db856a47893931da64e43f5a74708c">GetOutlookEntryId</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem olItem)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keywordflow">return</span> olItem.EntryID;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a113ddde8644c4941e960e066579d07ad">  389</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">bool</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a113ddde8644c4941e960e066579d07ad">IsCurrentView</a> =&gt; <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#aa43bada282eea7628099f2f2d75d0ca2">Context</a>.<a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context.html#a5dcb16ae273015ba82ff59d1ca4f27d8">CurrentFolderItemType</a> == <a class="code" href="namespace_outlook.html">Outlook</a>.OlItemType.olTaskItem;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">// Should presumably be removed at some point. Existing code was ignoring deletions for Contacts and Tasks</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="comment">// (but not for Appointments).</span></div><div class="line"><a name="l00393"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a73090813259ceb76a8bd65b41e6e42ad">  393</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">bool</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a73090813259ceb76a8bd65b41e6e42ad">PropagatesLocalDeletions</a> =&gt; <span class="keyword">true</span>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#aa2e207825949ebdbbe67d75560f3bd92">  403</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">override</span> <a class="code" href="namespace_outlook.html">Outlook</a>.OlSensitivity <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#aa2e207825949ebdbbe67d75560f3bd92">GetSensitivity</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem olItem)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">return</span> olItem.Sensitivity;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a0f4a96fa2a49300a9ca6bd247f761282">  408</a></span>&#160;        <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">bool</span> <a class="code" href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a0f4a96fa2a49300a9ca6bd247f761282">IsMatch</a>(<a class="code" href="namespace_outlook.html">Outlook</a>.TaskItem olItem, <a class="code" href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html">eEntryValue</a> crmItem)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="keywordflow">return</span> olItem.Subject == crmItem.GetValueAsString(<span class="stringliteral">&quot;name&quot;</span>) &amp;&amp;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                olItem.StartDate.ToUniversalTime() == crmItem.GetValueAsDateTime(<span class="stringliteral">&quot;date_start&quot;</span>).ToUniversalTime();</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div><div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_a214d7e1a0000e29128954b3e6516fbb8"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a214d7e1a0000e29128954b3e6516fbb8">SuiteCRMAddIn.BusinessLogic.TaskSyncing.SaveItem</a></div><div class="ttdeci">override void SaveItem(Outlook.TaskItem olItem)</div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00109">TaskSyncing.cs:109</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_a8c1e906f4a8c369c69e5cdbb73c1cfb2"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a8c1e906f4a8c369c69e5cdbb73c1cfb2">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.TaskItem &gt;::EnsureSynchronisationPropertiesForOutlookItem</a></div><div class="ttdeci">void EnsureSynchronisationPropertiesForOutlookItem(OutlookItemType olItem, string modifiedDate, string type, string entryId)</div><div class="ttdoc">Every Outlook item which is to be synchronised must have a property SOModifiedDate, a property SType, and a property SEntryId, referencing respectively the last time it was modified, the type of CRM item it is to be synchronised with, and the id of the CRM item it is to be synchronised with. </div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00628">Synchroniser.cs:628</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_a113ddde8644c4941e960e066579d07ad"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a113ddde8644c4941e960e066579d07ad">SuiteCRMAddIn.BusinessLogic.TaskSyncing.IsCurrentView</a></div><div class="ttdeci">override bool IsCurrentView</div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00389">TaskSyncing.cs:389</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper_html_a7bbecd35543154e9785fcfd7788f54e8"><div class="ttname"><a href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html#a7bbecd35543154e9785fcfd7788f54e8">SuiteCRMClient.clsSuiteCRMHelper.SetEntryUnsafe</a></div><div class="ttdeci">static string SetEntryUnsafe(eNameValue[] data, string moduleName=&quot;Emails&quot;)</div><div class="ttdoc">Sets an entry in CRM and returns the id. &amp;#39;Unsafe&amp;#39; because if it fails (for whatever reason)...</div><div class="ttdef"><b>Definition:</b> <a href="cls_suite_c_r_m_helper_8cs_source.html#l00202">clsSuiteCRMHelper.cs:202</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_a1ba9633b7bee7b424510c387b2fd6636"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a1ba9633b7bee7b424510c387b2fd6636">SuiteCRMAddIn.BusinessLogic.TaskSyncing.Direction</a></div><div class="ttdeci">override SyncDirection.Direction Direction</div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00074">TaskSyncing.cs:74</a></div></div>
<div class="ttc" id="namespace_outlook_html"><div class="ttname"><a href="namespace_outlook.html">Outlook</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context_html_a5dcb16ae273015ba82ff59d1ca4f27d8"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context.html#a5dcb16ae273015ba82ff59d1ca4f27d8">SuiteCRMAddIn.BusinessLogic.SyncContext.CurrentFolderItemType</a></div><div class="ttdeci">Outlook.OlItemType CurrentFolderItemType</div><div class="ttdef"><b>Definition:</b> <a href="_sync_context_8cs_source.html#l00046">SyncContext.cs:46</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_a7382f87a4a0d953a72f84857a094a335"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a7382f87a4a0d953a72f84857a094a335">SuiteCRMAddIn.BusinessLogic.TaskSyncing.SyncFolder</a></div><div class="ttdeci">override void SyncFolder(Outlook.MAPIFolder folder, string crmModule)</div><div class="ttdoc">Synchronise items in the specified folder with the specified SuiteCRM module. </div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00120">TaskSyncing.cs:120</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_proto_items_1_1_proto_task_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_proto_items_1_1_proto_task.html">SuiteCRMAddIn.ProtoItems.ProtoTask</a></div><div class="ttdoc">Broadly, a C# representation of a CRM task. </div><div class="ttdef"><b>Definition:</b> <a href="_proto_task_8cs_source.html#l00035">ProtoTask.cs:35</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_a9e06c6056beacdb87f5d807f4739b9ba"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a9e06c6056beacdb87f5d807f4739b9ba">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.TaskItem &gt;::FindMatches</a></div><div class="ttdeci">List&lt; SyncState&lt; OutlookItemType &gt; &gt; FindMatches(eEntryValue crmItem)</div><div class="ttdoc">Find any existing Outlook items which appear to be identical to this CRM item. </div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00864">Synchroniser.cs:864</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_af216ea175725dcc03cdeed105d908d8f"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#af216ea175725dcc03cdeed105d908d8f">SuiteCRMAddIn.BusinessLogic.TaskSyncing.DefaultCrmModule</a></div><div class="ttdeci">override string DefaultCrmModule</div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00067">TaskSyncing.cs:67</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_aa2e207825949ebdbbe67d75560f3bd92"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#aa2e207825949ebdbbe67d75560f3bd92">SuiteCRMAddIn.BusinessLogic.TaskSyncing.GetSensitivity</a></div><div class="ttdeci">override Outlook.OlSensitivity GetSensitivity(Outlook.TaskItem olItem)</div><div class="ttdoc">Return the sensitivity of this outlook item. </div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00403">TaskSyncing.cs:403</a></div></div>
<div class="ttc" id="namespace_system_html"><div class="ttname"><a href="namespace_system.html">System</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_a2024b479b443ef00135870d5bbbfa4be"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a2024b479b443ef00135870d5bbbfa4be">SuiteCRMAddIn.BusinessLogic.TaskSyncing.AddOrUpdateItemFromCrmToOutlook</a></div><div class="ttdeci">override SyncState&lt; Outlook.TaskItem &gt; AddOrUpdateItemFromCrmToOutlook(Outlook.MAPIFolder tasksFolder, string crmType, eEntryValue crmItem)</div><div class="ttdoc">Update a single item in the specified Outlook folder with changes from CRM. If the item does not exis...</div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00167">TaskSyncing.cs:167</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_a9a2c3473c4dc60793fed0588c66f8666"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a9a2c3473c4dc60793fed0588c66f8666">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.TaskItem &gt;::ParseDateTimeFromUserProperty</a></div><div class="ttdeci">DateTime ParseDateTimeFromUserProperty(string propertyValue)</div><div class="ttdoc">Parse a date time object from a user property, assuming the ISO 8601 date-time format but ommitting t...</div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00767">Synchroniser.cs:767</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_acc7036a95cd34952cf01c774b1fcefc2"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#acc7036a95cd34952cf01c774b1fcefc2">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.TaskItem &gt;::MergeRecordsFromCrm</a></div><div class="ttdeci">virtual void MergeRecordsFromCrm(Outlook.MAPIFolder folder, string crmModule, HashSet&lt; SyncState&lt; OutlookItemType &gt;&gt; untouched)</div><div class="ttdoc">Fetch records in pages from CRM, and merge them into Outlook. </div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00785">Synchroniser.cs:785</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_a0f4a96fa2a49300a9ca6bd247f761282"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a0f4a96fa2a49300a9ca6bd247f761282">SuiteCRMAddIn.BusinessLogic.TaskSyncing.IsMatch</a></div><div class="ttdeci">override bool IsMatch(Outlook.TaskItem olItem, eEntryValue crmItem)</div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00408">TaskSyncing.cs:408</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value_html_a338413e27f0a446a3fdd15ba6c7b047b"><div class="ttname"><a href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html#a338413e27f0a446a3fdd15ba6c7b047b">SuiteCRMClient.RESTObjects.eEntryValue.id</a></div><div class="ttdeci">string id</div><div class="ttdef"><b>Definition:</b> <a href="e_entry_value_8cs_source.html#l00048">eEntryValue.cs:48</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction_html_aee195368e938ed8e05fa3ec669838c06"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html#aee195368e938ed8e05fa3ec669838c06">SuiteCRMAddIn.BusinessLogic.SyncDirection.Direction</a></div><div class="ttdeci">Direction</div><div class="ttdoc">The actual directions </div><div class="ttdef"><b>Definition:</b> <a href="_sync_direction_8cs_source.html#l00034">SyncDirection.cs:34</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_client_1_1_logging_html"><div class="ttname"><a href="namespace_suite_c_r_m_client_1_1_logging.html">SuiteCRMClient.Logging</a></div><div class="ttdef"><b>Definition:</b> <a href="_abstract_logger_8cs_source.html#l00023">AbstractLogger.cs:23</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_ac49de51ba359f2bf8567a6630e0b4183"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#ac49de51ba359f2bf8567a6630e0b4183">SuiteCRMAddIn.BusinessLogic.TaskSyncing.LogItemAction</a></div><div class="ttdeci">override void LogItemAction(Outlook.TaskItem olItem, string message)</div><div class="ttdoc">Log a message regarding this Outlook appointment. </div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00150">TaskSyncing.cs:150</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_a27c5e331d34016150efc67dbbaa78dca"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a27c5e331d34016150efc67dbbaa78dca">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.TaskItem &gt;::Application</a></div><div class="ttdeci">Outlook.Application Application</div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00181">Synchroniser.cs:181</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_a8a33d4ec8cdb1715295928c5e69308c8"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a8a33d4ec8cdb1715295928c5e69308c8">SuiteCRMAddIn.BusinessLogic.TaskSyncing.TransmissionLock</a></div><div class="ttdeci">override object TransmissionLock</div><div class="ttdoc">Allow my parent class to access my transmission lock object. </div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00059">TaskSyncing.cs:59</a></div></div>
<div class="ttc" id="namespace_exception_html"><div class="ttname"><a href="namespace_exception.html">Exception</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_client_1_1_r_e_s_t_objects_html"><div class="ttname"><a href="namespace_suite_c_r_m_client_1_1_r_e_s_t_objects.html">SuiteCRMClient.RESTObjects</a></div><div class="ttdoc">The RESTObjects package contains classes which may be deserialised from JSON messages sent by CRM...</div><div class="ttdef"><b>Definition:</b> <a href="_suite_c_r_m_client_2_r_e_s_t_objects_2_documentation_8cs_source.html#l00015">Documentation.cs:15</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value_html"><div class="ttname"><a href="class_suite_c_r_m_client_1_1_r_e_s_t_objects_1_1e_entry_value.html">SuiteCRMClient.RESTObjects.eEntryValue</a></div><div class="ttdef"><b>Definition:</b> <a href="e_entry_value_8cs_source.html#l00032">eEntryValue.cs:32</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_a0e5f996da330d5139080fb1622fd4133"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a0e5f996da330d5139080fb1622fd4133">SuiteCRMAddIn.BusinessLogic.TaskSyncing.ConstructSyncState</a></div><div class="ttdeci">override SyncState&lt; Outlook.TaskItem &gt; ConstructSyncState(Outlook.TaskItem olItem)</div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00374">TaskSyncing.cs:374</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_sync_state_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_sync_state.html">SuiteCRMAddIn.BusinessLogic.TaskSyncState</a></div><div class="ttdoc">A SyncState for Contact items. </div><div class="ttdef"><b>Definition:</b> <a href="_task_sync_state_8cs_source.html#l00032">TaskSyncState.cs:32</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_a2b059d9877f7222cf924244e4c229e98"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a2b059d9877f7222cf924244e4c229e98">SuiteCRMAddIn.BusinessLogic.TaskSyncing.TaskSyncing</a></div><div class="ttdeci">TaskSyncing(string name, SyncContext context)</div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00044">TaskSyncing.cs:44</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_acc0767f43a7c30dea23d8c6023edd2ab"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#acc0767f43a7c30dea23d8c6023edd2ab">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.TaskItem &gt;::fetchQueryPrefix</a></div><div class="ttdeci">string fetchQueryPrefix</div><div class="ttdoc">The prefix for the fetch query, used in FetchRecordsFromCrm, q.v. </div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00074">Synchroniser.cs:74</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_abdadd3dfda9dd4705d0f25da315d12b4"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#abdadd3dfda9dd4705d0f25da315d12b4">SuiteCRMAddIn.BusinessLogic.TaskSyncing.CrmModule</a></div><div class="ttdeci">const string CrmModule</div><div class="ttdoc">The module I synchronise with. </div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00042">TaskSyncing.cs:42</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_aa0db856a47893931da64e43f5a74708c"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#aa0db856a47893931da64e43f5a74708c">SuiteCRMAddIn.BusinessLogic.TaskSyncing.GetOutlookEntryId</a></div><div class="ttdeci">override string GetOutlookEntryId(Outlook.TaskItem olItem)</div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00384">TaskSyncing.cs:384</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_a73090813259ceb76a8bd65b41e6e42ad"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a73090813259ceb76a8bd65b41e6e42ad">SuiteCRMAddIn.BusinessLogic.TaskSyncing.PropagatesLocalDeletions</a></div><div class="ttdeci">override bool PropagatesLocalDeletions</div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00393">TaskSyncing.cs:393</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_aa43bada282eea7628099f2f2d75d0ca2"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#aa43bada282eea7628099f2f2d75d0ca2">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.TaskItem &gt;::Context</a></div><div class="ttdeci">SyncContext Context</div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00179">Synchroniser.cs:179</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_add_in_1_1_proto_items_html"><div class="ttname"><a href="namespace_suite_c_r_m_add_in_1_1_proto_items.html">SuiteCRMAddIn.ProtoItems</a></div><div class="ttdoc">ProtoItems are C# implementations of CRM classes, in order to make serialising to JSON easier...</div><div class="ttdef"><b>Definition:</b> <a href="_suite_c_r_m_add_in_2_proto_items_2_documentation_8cs_source.html#l00004">Documentation.cs:4</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_direction.html">SuiteCRMAddIn.BusinessLogic.SyncDirection</a></div><div class="ttdoc">A direction in which things may be synchronised. Directions are named with respect to CRM...</div><div class="ttdef"><b>Definition:</b> <a href="_sync_direction_8cs_source.html#l00029">SyncDirection.cs:29</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper_html"><div class="ttname"><a href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html">SuiteCRMClient.clsSuiteCRMHelper</a></div><div class="ttdef"><b>Definition:</b> <a href="cls_suite_c_r_m_helper_8cs_source.html#l00035">clsSuiteCRMHelper.cs:35</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_a5ffca39ee66e0c50f42ea434e3f9af9d"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a5ffca39ee66e0c50f42ea434e3f9af9d">SuiteCRMAddIn.BusinessLogic.TaskSyncing.ConstructAndDespatchCrmItem</a></div><div class="ttdeci">override string ConstructAndDespatchCrmItem(Outlook.TaskItem olItem, string crmType, string entryId)</div><div class="ttdoc">Construct a JSON packet representing this Outlook item, and despatch it to CRM. </div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00307">TaskSyncing.cs:307</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_a8fdcfc454a40b663c20842f70ab57f8b"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a8fdcfc454a40b663c20842f70ab57f8b">SuiteCRMAddIn.BusinessLogic.TaskSyncing.GetDefaultFolder</a></div><div class="ttdeci">override Outlook.MAPIFolder GetDefaultFolder()</div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00369">TaskSyncing.cs:369</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_a5120593ccd24bdd38cd5609ed0c5a504"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a5120593ccd24bdd38cd5609ed0c5a504">SuiteCRMAddIn.BusinessLogic.TaskSyncing.GetOutlookItems</a></div><div class="ttdeci">override void GetOutlookItems(Outlook.MAPIFolder taskFolder)</div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00313">TaskSyncing.cs:313</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_a0ea303cb4210eb22c79d6f8f0d859a39"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a0ea303cb4210eb22c79d6f8f0d859a39">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.TaskItem &gt;::ItemsSyncState</a></div><div class="ttdeci">ThreadSafeList&lt; SyncState&lt; OutlookItemType &gt; &gt; ItemsSyncState</div><div class="ttdoc">List of the synchronisation state of all items which may require synchronisation. ...</div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00188">Synchroniser.cs:188</a></div></div>
<div class="ttc" id="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper_html_a050637c0cbd1012cf9cf58c5cb3d179c"><div class="ttname"><a href="class_suite_c_r_m_client_1_1cls_suite_c_r_m_helper.html#a050637c0cbd1012cf9cf58c5cb3d179c">SuiteCRMClient.clsSuiteCRMHelper.GetUserId</a></div><div class="ttdeci">static string GetUserId()</div><div class="ttdoc">Return the CRM id of the current user. </div><div class="ttdef"><b>Definition:</b> <a href="cls_suite_c_r_m_helper_8cs_source.html#l00156">clsSuiteCRMHelper.cs:156</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_context.html">SuiteCRMAddIn.BusinessLogic.SyncContext</a></div><div class="ttdoc">A bundle of handles onto all the things which are needed to allow synchronisation to take place...</div><div class="ttdef"><b>Definition:</b> <a href="_sync_context_8cs_source.html#l00031">SyncContext.cs:31</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_a22031f77a31ab4d27818815ebc85786d"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a22031f77a31ab4d27818815ebc85786d">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.TaskItem &gt;::GetExistingSyncState</a></div><div class="ttdeci">SyncState&lt; OutlookItemType &gt; GetExistingSyncState(OutlookItemType olItem)</div><div class="ttdoc">Get the existing sync state representing this item, if it exists, else null. </div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00503">Synchroniser.cs:503</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html_a483e9fe3f7b8356dd85b53d7d4014f50"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html#a483e9fe3f7b8356dd85b53d7d4014f50">SuiteCRMAddIn.BusinessLogic.Synchroniser&lt; Outlook.TaskItem &gt;::ResolveUnmatchedItems</a></div><div class="ttdeci">void ResolveUnmatchedItems(IEnumerable&lt; SyncState&lt; OutlookItemType &gt;&gt; itemsToResolve, string crmModule)</div><div class="ttdoc">Given a list of items which exist in Outlook but are missing from CRM, resolve how to handle them...</div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00252">Synchroniser.cs:252</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_sync_state.html">SuiteCRMAddIn.BusinessLogic.SyncState</a></div><div class="ttdoc">Superclass for SyncState&lt;T&gt;, q.v.. </div><div class="ttdef"><b>Definition:</b> <a href="_sync_state_8cs_source.html#l00033">SyncState.cs:33</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_client_html"><div class="ttname"><a href="namespace_suite_c_r_m_client.html">SuiteCRMClient</a></div><div class="ttdoc">SuiteCRMClient is a client library for the SuiteCRM JSON API. </div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html">SuiteCRMAddIn.BusinessLogic.TaskSyncing</a></div><div class="ttdoc">An agent which synchronises Outlook Task items with CRM. </div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00037">TaskSyncing.cs:37</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser_html"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_synchroniser.html">SuiteCRMAddIn.BusinessLogic.Synchroniser</a></div><div class="ttdoc">Synchronise items of the class for which I am responsible. </div><div class="ttdef"><b>Definition:</b> <a href="_synchroniser_8cs_source.html#l00043">Synchroniser.cs:43</a></div></div>
<div class="ttc" id="namespace_suite_c_r_m_add_in_html"><div class="ttname"><a href="namespace_suite_c_r_m_add_in.html">SuiteCRMAddIn</a></div></div>
<div class="ttc" id="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing_html_a8c5a8adf1dff2b0d9074b2bd75ec27dd"><div class="ttname"><a href="class_suite_c_r_m_add_in_1_1_business_logic_1_1_task_syncing.html#a8c5a8adf1dff2b0d9074b2bd75ec27dd">SuiteCRMAddIn.BusinessLogic.TaskSyncing.EnsureSynchronisationPropertyForOutlookItem</a></div><div class="ttdeci">override void EnsureSynchronisationPropertyForOutlookItem(Outlook.TaskItem olItem, string name, string value)</div><div class="ttdef"><b>Definition:</b> <a href="_task_syncing_8cs_source.html#l00351">TaskSyncing.cs:351</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_3341eda471cc1faa5052bfebf1426198.html">SuiteCRMAddIn</a></li><li class="navelem"><a class="el" href="dir_3fb47a1533c09fa7ca776045a50683b4.html">BusinessLogic</a></li><li class="navelem"><a class="el" href="_task_syncing_8cs.html">TaskSyncing.cs</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
